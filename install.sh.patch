--- install.sh	2022-04-10 00:24:31.501640234 +0900
+++ src/xp-pen-pentablet-3.2.3.220323-1.x86_64/install.sh	2022-04-20 18:00:07.554764546 +0900
@@ -9,6 +9,21 @@
 echo $dirname
 cd "$dirname"
 
+
+
+# add rootDir for package
+rootDir="$1"
+if [ -n "${rootDir}" ]; then
+	if [ -d "${rootDir}" ]; then
+		rootDir="$(realpath "${rootDir}")"
+	else
+		echo "'${rootDir}' is not a directory"
+		exit 1
+	fi
+else
+	rootDir=""
+fi
+
 # close driver if it running
 AppName=pentablet
 AppDir=pentablet
@@ -37,15 +52,15 @@
 fi
 
 #Copy rule
-sysRuleDir="/lib/udev/rules.d"
-appRuleDir=./App$sysRuleDir
+sysRuleDir="${rootDir}/usr/lib/udev/rules.d"
+appRuleDir=./App/lib/udev/rules.d
 ruleName="10-xp-pen.rules"
 
 #echo "$appRuleDir/$ruleName"
 #echo "$sysRuleDir/$ruleName"
 
 if [ -f $appRuleDir/$ruleName ]; then
-	str=`cp $appRuleDir/$ruleName $sysRuleDir/$ruleName`
+	str=`install -D -m644 $appRuleDir/$ruleName $sysRuleDir/$ruleName`
 	if [ "$str" !=  "" ]; then 
 		echo "$str";
 	fi
@@ -55,8 +70,8 @@
 fi
 
 #install app
-sysAppDir="/usr/lib"
-appAppDir=./App$sysAppDir/$AppName
+sysAppDir="${rootDir}/usr/lib"
+appAppDir=./App/usr/lib/$AppName
 exeShell="pentablet.sh"
 
 #echo $sysAppDir
@@ -86,7 +101,7 @@
 
 #echo "exe path "$sysAppDir/$AppDir/$AppName
 if [ -f $sysAppDir/$AppDir/$AppName ]; then
-	str=`chmod +0555 $sysAppDir/$AppDir/$AppName`
+	str=`chmod +0755 $sysAppDir/$AppDir/$AppName`
 	if [ "$str" !=  "" ]; then 
 		echo "Cannot add permission to app"
 		echo "$str";
@@ -97,13 +112,13 @@
 fi
 
 # install shortcut
-sysDesktopDir=/usr/share/applications
-sysAppIconDir=/usr/share/icons
-sysAutoStartDir=/etc/xdg/autostart
-
-appDesktopDir=./App$sysDesktopDir
-appAppIconDir=./App$sysAppIconDir
-appAutoStartDir=./App$sysAutoStartDir
+sysDesktopDir="${rootDir}/usr/share/applications"
+sysAppIconDir="${rootDir}/usr/share/icons"
+#sysAutoStartDir="${rootDir}/etc/xdg/autostart"
+
+appDesktopDir=./App/usr/share/applications
+appAppIconDir=./App/usr/share/icons
+#appAutoStartDir=./App/etc/xdg/autostart
 
 appDesktopName=xp$AppName.desktop
 appIconName=$AppName.png
@@ -134,60 +149,60 @@
 	exit
 fi
 
-if [ -f $appAutoStartDir/$appDesktopName ]; then
-	str=`cp $appAutoStartDir/$appDesktopName $sysAutoStartDir/$appDesktopName`
-	if [ "$str" !=  "" ]; then 
-		echo "$str"
-	fi
-else
-	echo "Cannot find set auto start"
-fi
+#if [ -f $appAutoStartDir/$appDesktopName ]; then
+#	str=`cp $appAutoStartDir/$appDesktopName $sysAutoStartDir/$appDesktopName`
+#	if [ "$str" !=  "" ]; then 
+#		echo "$str"
+#	fi
+#else
+#	echo "Cannot find set auto start"
+#fi
 
-absAppDir=/usr/lib/pentablet
+absAppDir=${rootDir}/usr/lib/pentablet
 absConfPath=$absAppDir/conf/xppen
 absLibPath=$absAppDir/lib
 absPlatPath=$absAppDir/platforms
 
 
-chmod +0777 /etc/xdg/autostart/xppentablet.desktop
-chmod +0777 /usr/share/applications/xppentablet.desktop
-chmod +0777 /usr/share/icons/pentablet.png
-
-chmod +0777 $absAppDir/pentablet
-chmod +0777 $absAppDir/pentablet.sh
-chmod +0666 $absAppDir/resource.rcc
-
-chmod +0777 $absConfPath
-chmod +0777 $absLibPath
-chmod +0777 $absPlatPath
+#chmod +0777 /etc/xdg/autostart/xppentablet.desktop
+#chmod +0777 /usr/share/applications/xppentablet.desktop
+#chmod +0777 /usr/share/icons/pentablet.png
+
+chmod +0755 $absAppDir/pentablet
+chmod +0755 $absAppDir/pentablet.sh
+chmod +0644 $absAppDir/resource.rcc
+
+#chmod +0777 $absConfPath
+#chmod +0777 $absLibPath
+#chmod +0777 $absPlatPath
 
 chmod +0666 $absConfPath/config.xml
 chmod +0666 $absConfPath/language.ini
 chmod +0666 $absConfPath/name_config.ini
 
-chmod +0666 $absLibPath/libicudata.so.56
-chmod +0666 $absLibPath/libicui18n.so.56
-chmod +0666 $absLibPath/libicuuc.so.56
-chmod +0666 $absLibPath/libQt5Core.so.5
-chmod +0666 $absLibPath/libQt5DBus.so.5
-chmod +0666 $absLibPath/libQt5Gui.so.5
-chmod +0666 $absLibPath/libQt5Network.so.5
-chmod +0666 $absLibPath/libQt5Widgets.so.5
-chmod +0666 $absLibPath/libQt5X11Extras.so.5
-chmod +0666 $absLibPath/libQt5XcbQpa.so.5
-chmod +0666 $absLibPath/libQt5Xml.so.5
+#chmod +0666 $absLibPath/libicudata.so.56
+#chmod +0666 $absLibPath/libicui18n.so.56
+#chmod +0666 $absLibPath/libicuuc.so.56
+#chmod +0666 $absLibPath/libQt5Core.so.5
+#chmod +0666 $absLibPath/libQt5DBus.so.5
+#chmod +0666 $absLibPath/libQt5Gui.so.5
+#chmod +0666 $absLibPath/libQt5Network.so.5
+#chmod +0666 $absLibPath/libQt5Widgets.so.5
+#chmod +0666 $absLibPath/libQt5X11Extras.so.5
+#chmod +0666 $absLibPath/libQt5XcbQpa.so.5
+#chmod +0666 $absLibPath/libQt5Xml.so.5
 
-chmod +0666 $absPlatPath/libqxcb.so
+#chmod +0644 $absPlatPath/libqxcb.so
 
 lockfile="/tmp/qtsingleapp-Pentab-9c9b-lockfile"
 touch $lockfile
 chmod +0666 $lockfile
 
 
-if [ -f "/etc/xdg/autostart/pentablet.desktop" ]; then
-	rm /etc/xdg/autostart/ugee-pentablet.desktop
-fi
+#if [ -f "${rootDir}/etc/xdg/autostart/pentablet.desktop" ]; then
+#	rm ${rootDir}/etc/xdg/autostart/ugee-pentablet.desktop
+#fi
 
 
-echo "Installation successful!"
+#echo "Installation successful!"
 echo "If you are installing for the first time, please use it after restart."
