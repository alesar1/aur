# Trezor-bridge-bin install script

pre_install() {
    getent group trezord >/dev/null || groupadd -r trezord
    getent group plugdev >/dev/null || groupadd -r plugdev
    getent passwd trezord >/dev/null || useradd -r -g trezord -d /var -s /usr/bin/nologin -c "TREZOR Bridge" trezord
    usermod -a -G plugdev trezord
    touch /var/log/trezord.log
    chown trezord:trezord /var/log/trezord.log
    chmod 660 /var/log/trezord.log
}

post_install() {
    systemctl daemon-reload
    systemctl enable --now trezord.service
}

pre_upgrade() {
    systemctl stop trezord.service
}

post_upgrade() {
    systemctl daemon-reload
    systemctl start trezord.service
}

pre_remove() {
    systemctl stop trezord.service
    systemctl disable trezord.service
}
