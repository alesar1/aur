From 0cd905ce9942c8d7c85202c160aaf71d17468911 Mon Sep 17 00:00:00 2001
From: Jan Cholasta <jcholast@redhat.com>
Date: Tue, 2 Aug 2016 12:56:44 +0200
Subject: [PATCH 2/3] dogtag, vault: do not import `pki` in makeapi

---
 ipaserver/plugins/dogtag.py | 2 +-
 ipaserver/plugins/vault.py  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/ipaserver/plugins/dogtag.py b/ipaserver/plugins/dogtag.py
index aef1e88..53c3270 100644
--- a/ipaserver/plugins/dogtag.py
+++ b/ipaserver/plugins/dogtag.py
@@ -253,7 +253,7 @@ import ipapython.cookie
 from ipapython import dogtag
 from ipapython import ipautil
 
-if api.env.in_server:
+if not api.env.validate_api:
     import pki
     from pki.client import PKIConnection
     import pki.crypto as cryptoutil
diff --git a/ipaserver/plugins/vault.py b/ipaserver/plugins/vault.py
index 5c4c096..2f097e2 100644
--- a/ipaserver/plugins/vault.py
+++ b/ipaserver/plugins/vault.py
@@ -35,7 +35,7 @@ from ipalib import _, ngettext
 from ipapython import kerberos
 from ipapython.dn import DN
 
-if api.env.in_server:
+if not api.env.validate_api:
     import pki.account
     import pki.key
 
-- 
2.7.4

