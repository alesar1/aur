From 7002cc97bfa2ddc9666551e9b4536d6e106a0137 Mon Sep 17 00:00:00 2001
From: Jan Cholasta <jcholast@redhat.com>
Date: Tue, 2 Aug 2016 12:56:44 +0200
Subject: [PATCH] dogtag, vault: do not import `pki` in makeapi

---
 ipaserver/plugins/dogtag.py | 2 +-
 ipaserver/plugins/vault.py  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/ipaserver/plugins/dogtag.py b/ipaserver/plugins/dogtag.py
index 644b41e90f2d377ae9b70cf4719ab8789fdfc649..448b82b4a0749b6eb99ef7d1e3a9ea4501410a1d 100644
--- a/ipaserver/plugins/dogtag.py
+++ b/ipaserver/plugins/dogtag.py
@@ -253,7 +253,7 @@ import ipapython.cookie
 from ipapython import dogtag
 from ipapython import ipautil
 
-if api.env.in_server:
+if not api.env.validate_api:
     import pki
     from pki.client import PKIConnection
     import pki.crypto as cryptoutil
diff --git a/ipaserver/plugins/vault.py b/ipaserver/plugins/vault.py
index 5c4c09685ceb95c6634306c4275008d602099e12..2f097e20327d88448dc470ab3ae719e585a4a8df 100644
--- a/ipaserver/plugins/vault.py
+++ b/ipaserver/plugins/vault.py
@@ -35,7 +35,7 @@ from ipalib import _, ngettext
 from ipapython import kerberos
 from ipapython.dn import DN
 
-if api.env.in_server:
+if not api.env.validate_api:
     import pki.account
     import pki.key
 
-- 
2.11.0

