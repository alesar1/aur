diff -U 3 -dHrN -- mariadb-10.3.12_old/cmake/check_compiler_flag.cmake mariadb-10.3.12/cmake/check_compiler_flag.cmake
--- mariadb-10.3.12_old/cmake/check_compiler_flag.cmake	2019-01-04 16:28:48.000000000 +0100
+++ mariadb-10.3.12/cmake/check_compiler_flag.cmake	2019-01-16 09:59:23.143273756 +0100
@@ -1,36 +1,5 @@
-include(CheckCSourceCompiles)
-include(CheckCXXSourceCompiles)
-# We need some extra FAIL_REGEX patterns
-# Note that CHECK_C_SOURCE_COMPILES is a misnomer, it will also link.
-SET(fail_patterns
-    FAIL_REGEX "argument unused during compilation"
-    FAIL_REGEX "unsupported .*option"
-    FAIL_REGEX "unknown .*option"
-    FAIL_REGEX "unrecognized .*option"
-    FAIL_REGEX "ignoring unknown option"
-    FAIL_REGEX "warning:.*ignored"
-    FAIL_REGEX "warning:.*is valid for.*but not for"
-    FAIL_REGEX "warning:.*redefined"
-    FAIL_REGEX "[Ww]arning: [Oo]ption"
-    )
-
-MACRO (MY_CHECK_C_COMPILER_FLAG flag)
-  STRING(REGEX REPLACE "[-,= +]" "_" result "have_C_${flag}")
-  SET(SAVE_CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS}")
-  SET(CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS} ${flag}")
-  CHECK_C_SOURCE_COMPILES("int main(void) { return 0; }" ${result}
-    ${fail_patterns})
-  SET(CMAKE_REQUIRED_FLAGS "${SAVE_CMAKE_REQUIRED_FLAGS}")
-ENDMACRO()
-
-MACRO (MY_CHECK_CXX_COMPILER_FLAG flag)
-  STRING(REGEX REPLACE "[-,= +]" "_" result "have_CXX_${flag}")
-  SET(SAVE_CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS}")
-  SET(CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS} ${flag}")
-  CHECK_CXX_SOURCE_COMPILES("int main(void) { return 0; }" ${result}
-    ${fail_patterns})
-  SET(CMAKE_REQUIRED_FLAGS "${SAVE_CMAKE_REQUIRED_FLAGS}")
-ENDMACRO()
+include(CheckCCompilerFlag)
+include(CheckCXXCompilerFlag)
 
 FUNCTION(MY_CHECK_AND_SET_COMPILER_FLAG flag_to_set)
   # At the moment this is gcc-only.
@@ -39,11 +8,11 @@
     RETURN()
   ENDIF()
   STRING(REGEX REPLACE "^-Wno-" "-W" flag_to_check ${flag_to_set})
-  MY_CHECK_C_COMPILER_FLAG(${flag_to_check})
-  MY_CHECK_CXX_COMPILER_FLAG(${flag_to_check})
+  check_c_compiler_flag(${flag_to_check} have_C_${flag_to_check})
+  check_cxx_compiler_flag(${flag_to_check} have_CXX_${flag_to_check})
   STRING(REGEX REPLACE "[-,= +]" "_" result "${flag_to_check}")
   FOREACH(lang C CXX)
-    IF (have_${lang}_${result})
+    IF (have_${lang}_${flag_to_check})
       IF(ARGN)
         FOREACH(type ${ARGN})
           SET(CMAKE_${lang}_FLAGS_${type} "${CMAKE_${lang}_FLAGS_${type}} ${flag_to_set}" PARENT_SCOPE)
diff -U 3 -dHrN -- mariadb-10.3.12_old/CMakeLists.txt mariadb-10.3.12/CMakeLists.txt
--- mariadb-10.3.12_old/CMakeLists.txt	2019-01-04 16:28:48.000000000 +0100
+++ mariadb-10.3.12/CMakeLists.txt	2019-01-16 10:00:46.533805602 +0100
@@ -14,7 +14,8 @@
 # along with this program; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 
-CMAKE_MINIMUM_REQUIRED(VERSION 2.8.7)
+# Not sure, if we could push this further up, 3.0.2 is the oldest documented 3.X version with check_c(xx)_compiler_flag
+CMAKE_MINIMUM_REQUIRED(VERSION 3.0.2 FATAL_ERROR)
 
 IF(POLICY CMP0022)
   CMAKE_POLICY(SET CMP0022 NEW)
diff -U 3 -dHrN -- mariadb-10.3.12_old/configure.cmake mariadb-10.3.12/configure.cmake
--- mariadb-10.3.12_old/configure.cmake	2019-01-04 16:28:48.000000000 +0100
+++ mariadb-10.3.12/configure.cmake	2019-01-16 09:59:06.603167181 +0100
@@ -277,7 +277,7 @@
 FIND_PACKAGE (Threads)
 
 FUNCTION(MY_CHECK_PTHREAD_ONCE_INIT)
-  MY_CHECK_C_COMPILER_FLAG("-Werror")
+  check_c_compiler_flag("-Werror" have_C__Werror)
   IF(NOT have_C__Werror)
     RETURN()
   ENDIF()
