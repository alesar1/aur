diff --git a/libtransmission/upnp.c b/libtransmission/upnp.c
index 14b2f25..743c894 100644
--- a/libtransmission/upnp.c
+++ b/libtransmission/upnp.c
@@ -85,8 +85,12 @@
 {
   struct UPNPDev * ret;
   bool have_err;
-
-#if (MINIUPNPC_API_VERSION >= 8) /* adds ipv6 and error args */
+
+#if (MINIUPNPC_API_VERSION >= 14) /* adds ttl arg */
+  int err = UPNPDISCOVER_SUCCESS;
+  ret = upnpDiscover (msec, NULL, NULL, 0, 0, 2, &err);
+  have_err = err != UPNPDISCOVER_SUCCESS;
+#elif (MINIUPNPC_API_VERSION >= 8) /* adds ipv6 and error args */
   int err = UPNPDISCOVER_SUCCESS;
   ret = upnpDiscover (msec, NULL, NULL, 0, 0, &err);
   have_err = err != UPNPDISCOVER_SUCCESS;
