# Warning: This file has syntactically significant, mixed whitespace.
# The heredoc bodies are indented with tabs up to the block level.
# The tabs are for block indentation in the source code.
# The spaces following the tabs are for indentation of the printed output.

post_install() {
    if [[ ! -e /var/lib/oragono/ircd.db ]]; then
        cat <<-EOF
			==> oragono needs to initialize the database and have
			    certificates made available prior to use.
		EOF
        mkcert_howto
    fi
}

post_upgrade() {
    if (( "$(vercmp "$2" 2.1.0)" < 0 )); then
        cat <<-EOF
			==> The tls certificate filenames in the default config have changed.
			    In /var/lib/oragono/:
			        tls.crt -> fullchain.pem
			        tls.key -> privkey.pem

			To generate new self-signed certificates:
		EOF
        mkcert_howto
    fi
}

mkcert_howto() {
    cat <<-EOF
		    cd /var/lib/oragono
		    sudo -u oragono /usr/bin/oragono mkcerts --conf /etc/oragono.conf
		    sudo -u oragono /usr/bin/oragono initdb --conf /etc/oragono.conf
	EOF
}
