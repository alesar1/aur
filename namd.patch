--- config	2016-10-20 23:50:56.000000000 +0300
+++ config	2018-03-20 19:01:59.899252611 +0300
@@ -400,43 +400,6 @@
     goto syntax
   endif
 
-  if ( $use_cuda || $use_mic ) then
-
-    if ( $?CHARM_ARCH ) then
-      set CHARM_ARCH_TEST = $CHARM_ARCH
-    else
-      set CHARM_ARCH_TEST = `awk '/^CHARMARCH =/ {print $3}' arch/$ARCH.arch`
-    endif
-
-    if ( $CHARM_ARCH_TEST =~ mpi-* ) then
-      set charm_arch_mpi = 1
-      if ( $CHARM_ARCH_TEST =~ *-win32* || $CHARM_ARCH_TEST =~ *-win64* ) then
-        set charm_arch_mpi = 0
-      endif
-    else
-      set charm_arch_mpi = 0
-    endif
-
-    if ( $CHARM_ARCH_TEST =~ *-smp* || $CHARM_ARCH_TEST =~ multicore-* ) then
-      set charm_arch_smp = 1
-    else
-      set charm_arch_smp = 0
-    endif
-
-    if ( $use_cuda ) set ERRTYPE = "CUDA"
-    if ( $use_mic ) set ERRTYPE = "MIC"
-
-    if ( $charm_arch_mpi || ! $charm_arch_smp ) then
-      echo ''
-      echo "ERROR: $ERRTYPE builds require non-MPI SMP or multicore Charm++ arch for reasonable performance."
-      echo ''
-      echo "Consider ibverbs-smp or verbs-smp (InfiniBand), gni-smp (Cray), or multicore (single node)."
-      echo ''
-      exit 1
-    endif
-
-  endif
-
   if ( $use_python ) then
     if ( ! $use_tcl ) then
       echo ''
--- arch/Linux-x86_64-g++.arch	2015-09-18 23:58:43.000000000 +0300
+++ arch/Linux-x86_64-g++.arch	2018-03-20 16:41:08.896644617 +0300
@@ -1,8 +1,8 @@
 NAMD_ARCH = Linux-x86_64
-CHARMARCH = multicore-linux64
+CHARMARCH = mpi-linux-x86_64
 
 CXX = g++ -m64 -std=c++0x -O3
-CXXOPTS = -fexpensive-optimizations -ffast-math 
+CXXOPTS = -fexpensive-optimizations -ffast-math -fPIC
 CC = gcc -m64 -O3
-COPTS = -fexpensive-optimizations -ffast-math
+COPTS = -fexpensive-optimizations -ffast-math -fPIC
 
--- arch/Linux-x86_64.cuda	2016-11-11 01:18:30.000000000 +0300
+++ arch/Linux-x86_64.cuda	2018-03-20 18:16:33.861159104 +0300
@@ -1,5 +1,5 @@
 
-CUDADIR=/usr/local/encap/cuda-6.5
+CUDADIR=/opt/cuda
 CUDAINCL=-I$(CUDADIR)/include
 CUBDIR=.rootdir/cub
 CUBINCL=-I$(CUBDIR)
@@ -9,6 +9,5 @@
 CUDAFLAGS=-DNAMD_CUDA
 CUDAOBJS=$(CUDAOBJSRAWSTATIC)
 CUDA=$(CUDAFLAGS) -I. $(CUDAINCL) $(CUBINCL)
-CUDACC=$(CUDADIR)/bin/nvcc -O3 --maxrregcount 48 $(CUDAGENCODE) -Xcompiler "-m64" $(CUDA)
-CUDAGENCODE=-gencode arch=compute_30,code=sm_30 -gencode arch=compute_30,code=compute_30 -gencode arch=compute_35,code=sm_35 -gencode arch=compute_35,code=compute_35 -gencode arch=compute_50,code=sm_50 -gencode arch=compute_50,code=compute_50
-
+CUDACC=$(CUDADIR)/bin/nvcc -O3 --maxrregcount 48 $(CUDAGENCODE) -Xcompiler "-m64" $(CUDA) --compiler-options -fPIC
+CUDAGENCODE=-gencode arch=compute_30,code=sm_30 -gencode arch=compute_35,code=sm_35 -gencode arch=compute_37,code=sm_37 -gencode arch=compute_50,code=sm_50 -gencode arch=compute_52,code=sm_52 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_61,code=compute_61
--- arch/Linux-x86_64.fftw3	2011-07-12 22:23:09.000000000 +0400
+++ arch/Linux-x86_64.fftw3	2018-03-20 16:41:30.256474225 +0300
@@ -1,5 +1,5 @@
 
-FFTDIR=$(HOME)/fftw3
+FFTDIR=/opt/fftw-static
 FFTINCL=-I$(FFTDIR)/include
 FFTLIB=-L$(FFTDIR)/lib -lfftw3f
 FFTFLAGS=-DNAMD_FFTW -DNAMD_FFTW_3
--- arch/Linux-x86_64.tcl	2011-06-18 00:38:43.000000000 +0400
+++ arch/Linux-x86_64.tcl	2018-03-20 19:03:56.218322669 +0300
@@ -1,8 +1,6 @@
 
-#TCLDIR=/Projects/namd2/tcl/tcl8.5.9-linux-x86_64
-TCLDIR=/Projects/namd2/tcl/tcl8.5.9-linux-x86_64-threaded
+TCLDIR=/opt/tcl85-static
 TCLINCL=-I$(TCLDIR)/include
-#TCLLIB=-L$(TCLDIR)/lib -ltcl8.5 -ldl
 TCLLIB=-L$(TCLDIR)/lib -ltcl8.5 -ldl -lpthread
 TCLFLAGS=-DNAMD_TCL
 TCL=$(TCLINCL) $(TCLFLAGS)
