diff -rupN a/llbuild/lib/BuildSystem/LaneBasedExecutionQueue.cpp b/llbuild/lib/BuildSystem/LaneBasedExecutionQueue.cpp
--- a/llbuild/lib/BuildSystem/LaneBasedExecutionQueue.cpp	2017-09-12 08:26:14.320282043 -0700
+++ b/llbuild/lib/BuildSystem/LaneBasedExecutionQueue.cpp	2017-09-12 08:25:50.040024445 -0700
@@ -231,7 +231,7 @@ public:
 #if defined(__linux__)
     sigset_t mostSignals;
     sigemptyset(&mostSignals);
-    for (int i = 1; i < SIGUNUSED; ++i) {
+    for (int i = 1; i < SIGSYS; ++i) {
       if (i == SIGKILL || i == SIGSTOP) continue;
       sigaddset(&mostSignals, i);
     }
diff -rupN a/llbuild/lib/Commands/NinjaBuildCommand.cpp b/llbuild/lib/Commands/NinjaBuildCommand.cpp
--- a/llbuild/lib/Commands/NinjaBuildCommand.cpp	2017-09-12 08:26:14.320282043 -0700
+++ b/llbuild/lib/Commands/NinjaBuildCommand.cpp	2017-09-12 08:25:50.040024445 -0700
@@ -1164,7 +1164,7 @@ buildCommand(BuildContext& context, ninj
 #if defined(__linux__)
       sigset_t mostSignals;
       sigemptyset(&mostSignals);
-      for (int i = 1; i < SIGUNUSED; ++i) {
+      for (int i = 1; i < SIGSYS; ++i) {
         if (i == SIGKILL || i == SIGSTOP) continue;
         sigaddset(&mostSignals, i);
       }
diff -rupN a/swift/stdlib/public/stubs/Stubs.cpp b/swift/stdlib/public/stubs/Stubs.cpp
--- a/swift/stdlib/public/stubs/Stubs.cpp	2017-09-12 08:26:27.680423806 -0700
+++ b/swift/stdlib/public/stubs/Stubs.cpp	2017-09-12 08:25:49.870022642 -0700
@@ -61,7 +61,7 @@ static long double swift_strtold_l(const
 #define strtof_l swift_strtof_l
 #define strtold_l swift_strtold_l
 #else
-#include <xlocale.h>
+#include <locale.h>
 #endif
 #include <limits>
 #include "llvm/ADT/StringExtras.h"
diff -rupN a/swift-corelibs-foundation/CoreFoundation/Base.subproj/CFInternal.h b/swift-corelibs-foundation/CoreFoundation/Base.subproj/CFInternal.h
--- a/swift-corelibs-foundation/CoreFoundation/Base.subproj/CFInternal.h	2017-09-12 08:25:03.549531343 -0700
+++ b/swift-corelibs-foundation/CoreFoundation/Base.subproj/CFInternal.h	2017-09-12 08:27:17.330950766 -0700
@@ -95,7 +95,7 @@ CF_EXTERN_C_BEGIN
 #if DEPLOYMENT_TARGET_MACOSX || DEPLOYMENT_TARGET_EMBEDDED || DEPLOYMENT_TARGET_EMBEDDED_MINI || DEPLOYMENT_TARGET_LINUX || DEPLOYMENT_TARGET_FREEBSD
 #if TARGET_OS_CYGWIN
 #else
-#include <xlocale.h>
+#include <locale.h>
 #endif
 #include <unistd.h>
 #include <sys/time.h>
diff -rupN a/swiftpm/Sources/Utility/Process.swift b/swiftpm/Sources/Utility/Process.swift
--- a/swiftpm/Sources/Utility/Process.swift	2017-09-12 09:03:10.154395376 -0700
+++ b/swiftpm/Sources/Utility/Process.swift	2017-09-12 09:03:36.114680619 -0700
@@ -140,7 +140,7 @@ public final class Process: ObjectIdenti
         // modify, so we have to take care about the set we use.
         var mostSignals = sigset_t()
         sigemptyset(&mostSignals);
-        for i in 1 ..< SIGUNUSED {
+        for i in 1 ..< SIGSYS {
             if i == SIGKILL || i == SIGSTOP {
                 continue
             }
