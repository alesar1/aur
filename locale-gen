#!/bin/sh --
# locale-gen: generate system locales

if [ ! -d /etc/locales ]; then
    printf '/etc/locales: no such directory\n' >&2
    exit 1
fi

for locale in /etc/locales/*; do
    if [ -f "$locale" ]; then
        read -r charset < "$locale"
        charset=${charset:-UTF-8}
        locale=${locale##*/}
    else
        continue
    fi

    printf '%s: generating locale\n' "$locale"."$charset" >&2

    localedef -i "$locale" -f "$charset" -c "$locale"."$charset"

    case $? in
        4) printf '%s: invalid locale\n' "$locale"."$charset" >&2
    esac
done
