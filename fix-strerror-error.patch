From 3105d145eb98e18c4781532a43d25c0f639830b2 Mon Sep 17 00:00:00 2001
From: Mario Limonciello <mario_limonciello@dell.com>
Date: Tue, 10 Nov 2015 18:13:48 -0600
Subject: [PATCH] Fix compile error against fwupdate git due to dropped
 functions.

Closes #37
---
 src/fu-provider-uefi.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/fu-provider-uefi.c b/src/fu-provider-uefi.c
index 6964169..fe2dbd2 100644
--- a/src/fu-provider-uefi.c
+++ b/src/fu-provider-uefi.c
@@ -213,6 +213,7 @@ fu_provider_uefi_update (FuProvider *provider,
 	fwup_resource *re = NULL;
 	gboolean ret = TRUE;
 	guint64 hardware_instance = 0;	/* FIXME */
+	int call;
 
 	/* get the hardware we're referencing */
 	fwup_resource_iter_create (&iter);
@@ -225,13 +226,14 @@ fu_provider_uefi_update (FuProvider *provider,
 	/* perform the update */
 	g_debug ("Performing UEFI capsule update");
 	fu_provider_set_status (provider, FWUPD_STATUS_SCHEDULING);
-	if (fwup_set_up_update (re, hardware_instance, fd) < 0) {
+	call = fwup_set_up_update (re, hardware_instance, fd);
+	if (call < 0) {
 		ret = FALSE;
 		g_set_error (error,
 			     FWUPD_ERROR,
 			     FWUPD_ERROR_NOT_SUPPORTED,
 			     "UEFI firmware update failed: %s",
-			     fwup_strerror (fwup_error));
+			     call);
 		goto out;
 	}
 out:
-- 
2.6.2

