# Maintainer: thorko contact@thorko.de
pkgname=sensu-backend
pkgver=6.7.3
pkgrel=2
pkgdesc="Sensu Go Backend"
arch=('x86_64' 'armv7h')
url='https://sensu.io'
license=('MIT')
if [ "$CARCH" = "armv7h" ]; then
  source=("${pkgname}-${pkgver}_armv7h.tar.gz::https://s3-us-west-2.amazonaws.com/sensu.io/sensu-go/${pkgver}/sensu-go_${pkgver}_linux_armv7.tar.gz")
  sha256sums=('88d7c13b7a7a0102629aeb624f00b6889b56bb09e1f8df73b017b212ea54f52e')
fi
if [ "$CARCH" = "x86_64" ]; then
	source=("${pkgname}-${pkgver}_x86_64.tar.gz::https://s3-us-west-2.amazonaws.com/sensu.io/sensu-go/${pkgver}/sensu-go_${pkgver}_linux_amd64.tar.gz")
  sha256sums=('d841590cf05e7f5fe0e99186b300f87a156944ef7f5faf9cf37b31b97891a2b4')
fi
if [ "$CARCH" = "aarch64" ]; then
	source=("${pkgname}-${pkgver}_aarch64.tar.gz::https://s3-us-west-2.amazonaws.com/sensu.io/sensu-go/${pkgver}/sensu-go_${pkgver}_linux_arm64.tar.gz")
  sha256sums=('219564419aa068c3c0908d7f1001df2b43cb33ed28d2838f54f5bd9ea1f8fa85')
fi

source+=(
        "sensu-backend.service"
        "backend.yml.example"
      )
sha256sums+=(
            '57c4e7835da2d58186e8e36518dc9e0b7cee93bd018619ec2a7210bf212d0d27'
            '29cf533a6b324ede8f2d774954bdbf879d0bf4470244cba5e7fbe1b935c1c4e9'
          )

install=sensu-backend.install

build() {
        tar xzvf ${pkgname}-${pkgver}_$CARCH.tar.gz
}



package() {
    install -Dm755 "${srcdir}/sensu-backend" "${pkgdir}/usr/bin/sensu-backend"
    install -Dm0644 "sensu-backend.service" "${pkgdir}/usr/lib/systemd/system/sensu-backend.service"
    install -Dm0644 "backend.yml.example" "${pkgdir}/etc/sensu/backend.yml.example"
}
