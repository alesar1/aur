# Maintainer: Simon Brulhart <simon@brulhart.me>

pkgname=python-taxi
pkgver=5.0
pkgrel=1
pkgdesc="Timesheeting tool that focuses on simplicity"
arch=('any')
license=('custom')
url="https://github.com/sephii/taxi"
depends=('python-appdirs' 'python-click' 'python-six')
makedepends=('python' 'python-setuptools')
optdepends=("python-taxi-zebra: Zebra backend for Taxi")
source=(
  "$pkgname-$pkgver.tar.gz::https://github.com/sephii/taxi/archive/$pkgver.tar.gz"
  taxi-complete.bash
  taxi-complete.zsh
)
sha512sums=('6c6fa4ad59a722dbec27733257aab53fc26c9ca453340fb29b4307e5f4aad01379b641be521a9a0863786c0330afec192cdfd37f861da350cd54dfbfb8cc676d'
            'cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e'
            'd02c0e3489dba8841eff335571088b739911d4c541623971cfef9b1628ea6960ad748e1e6c4cc1dfdd20dc88fc289f8078dbb51fa0402eed4868c45e87f4106a')

build() {
  cd "$srcdir/taxi-$pkgver"
  python setup.py build
}

package() {
  cd "$srcdir/taxi-$pkgver"
  python setup.py install --root="$pkgdir" --optimize=1
  install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE

  cd "$srcdir"
  # Completion file is generated by running `_TAXI_COMPLETE=source taxi > taxi-complete.bash`
  install -Dm644 taxi-complete.bash "$pkgdir"/usr/share/bash-completion/completions/taxi
  # Completion file is generated by running `_TAXI_COMPLETE=source_zsh taxi > taxi-complete.zsh`
  # and adding `#compdef taxi` on the first line
  install -Dm644 taxi-complete.zsh "$pkgdir"/usr/share/zsh/site-functions/_taxi
}
