# Maintainer: Adrian Perez de Castro <aperez@igalia.com>
pkgname=openradtool
pkgdesc='Generator for front-end and back-end code for Web applications written in C'
pkgver=0.7.4
pkgrel=1
url='https://kristaps.bsd.lv/openradtool'
license=(custom:BSD)
makedepends=(bc)
depends=(expat)
conflicts=(kwebapp)
replaces=(kwebapp)
optdepends=('ksql: Needed by code generated by openradtool')
arch=('x86_64')
source=("${url}/snapshots/openradtool-${pkgver}.tar.gz")
sha512sums=('318c6c880d7d1e86631826188ecd3d0d976d5decd3cb1a513577a03d90ce6428c5709921f8c34c2a11ec097944091076218520cdb4280daefd8b5375307c66d5')

build () {
	cd "${pkgname}-${pkgver}"
	./configure PREFIX=/usr MANDIR=/usr/share/man
	cat >> Makefile.configure <<-EOF
	CFLAGS += ${CFLAGS}
	LDFLAGS += ${LDFLAGS}
	EOF
	make
}

package () {
	cd "${pkgname}-${pkgver}"
	make install DESTDIR="${pkgdir}"
	awk '/^\/\*/,/\*\// { print ; }' main.c > COPYING
	install -Dm644 COPYING "${pkgdir}/usr/share/licenses/${pkgname}/COPYING"
}
