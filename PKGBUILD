# Maintainer: Tim Schumacher <timschumi@gmx.de>

pkgname=epk2extract-git
pkgver=r519
pkgrel=1
pkgdesc="Extraction tool for LG, Hisense, Sharp, Philips/TPV, Thompson and similar TVs/Embedded Devices"
license=(GPL2)
arch=($CARCH)
depends=()
makedepends=(cmake)
source=("git+https://github.com/openlgtv/epk2extract")
sha256sums=('SKIP')

pkgver() {
  cd "$srcdir/epk2extract"
  printf "r%d" "$(git rev-list --count HEAD)"
}

build() {
  cd "$srcdir/epk2extract"

  # As recommended by the README for non-Debug builds
  CMAKE_FLAGS=-DCMAKE_BUILD_TYPE=Test ./build.sh
}

package() {
  mkdir -p "$pkgdir/opt"
  cp -r "$srcdir/epk2extract/build_linux" "$pkgdir/opt/epk2extract"

  # Remove files generated by CMake
  rm -rf "$pkgdir/opt/epk2extract/obj"
}
