From 186791d46bfa1225deb1aee94770c54984d11971 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sl=C3=A1vek=20Banko?= <slavek.banko@axis.cz>
Date: Thu, 24 Feb 2022 20:24:20 +0100
Subject: [PATCH 1/3] Fix crash on corrupted wbxml.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Sl√°vek Banko <slavek.banko@axis.cz>
---
 src/wbxml_parser.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/wbxml_parser.c b/src/wbxml_parser.c
index c7f8dda..882dd22 100644
--- a/src/wbxml_parser.c
+++ b/src/wbxml_parser.c
@@ -2479,7 +2479,8 @@ static WBXMLError decode_opaque_content(WBXMLParser  *parser,
     case WBXML_LANG_SYNCML_SYNCML11: 
     case WBXML_LANG_SYNCML_SYNCML12: 
         /* NextNonce */
-        if ((parser->current_tag->wbxmlCodePage == 0x01) &&
+        if ((parser->current_tag) &&
+            (parser->current_tag->wbxmlCodePage == 0x01) &&
             (parser->current_tag->wbxmlToken == 0x10)) 
         {
             /* Decode base64 value */ 
-- 
2.35.1

