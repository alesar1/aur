diff -ruN cmocka-1.1.1/cmake/Modules/AddCMockaTest.cmake patched/cmake/Modules/AddCMockaTest.cmake
--- cmocka-1.1.1/cmake/Modules/AddCMockaTest.cmake	2018-08-25 22:13:02.393732017 +0200
+++ patched/cmake/Modules/AddCMockaTest.cmake	2018-08-25 22:14:20.245142615 +0200
@@ -19,5 +19,5 @@
 function (ADD_CMOCKA_TEST _testName _testSource)
     add_executable(${_testName} ${_testSource})
     target_link_libraries(${_testName} ${ARGN})
-    add_test(${_testName} ${CMAKE_CURRENT_BINARY_DIR}/${_testName}${CMAKE_EXECUTABLE_SUFFIX})
+    add_test(${_testName} ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/${_testName}${CMAKE_EXECUTABLE_SUFFIX})
 endfunction (ADD_CMOCKA_TEST)
diff -ruN cmocka-1.1.1/example/chef_wrap/CMakeLists.txt patched/example/chef_wrap/CMakeLists.txt
--- cmocka-1.1.1/example/chef_wrap/CMakeLists.txt	2018-08-25 22:13:02.393732017 +0200
+++ patched/example/chef_wrap/CMakeLists.txt	2018-08-25 22:14:09.604949817 +0200
@@ -9,7 +9,7 @@
 add_executable(waiter_test_wrap waiter_test_wrap.c chef.c)
 target_link_libraries(waiter_test_wrap ${CMOCKA_SHARED_LIBRARY})
 
-add_test(waiter_test_wrap ${CMAKE_CURRENT_BINARY_DIR}/waiter_test_wrap${CMAKE_EXECUTABLE_SUFFIX})
+add_test(waiter_test_wrap ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/waiter_test_wrap${CMAKE_EXECUTABLE_SUFFIX})
 
 set_target_properties(waiter_test_wrap
         PROPERTIES
diff -ruN cmocka-1.1.2/example/uptime/CMakeLists.txt patched/example/uptime/CMakeLists.txt
--- cmocka-1.1.2/example/uptime/CMakeLists.txt	2018-09-22 16:36:31.587036313 +0200
+++ patched/example/uptime/CMakeLists.txt	2018-09-22 16:36:23.656881286 +0200
@@ -18,4 +18,4 @@
     PROPERTIES
         LINK_FLAGS "-Wl,--wrap=uptime")
 
-add_test(test_uptime ${CMAKE_CURRENT_BINARY_DIR}/test_uptime${CMAKE_EXECUTABLE_SUFFIX})
+add_test(test_uptime ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/test_uptime${CMAKE_EXECUTABLE_SUFFIX})
diff -ruN cmocka-1.1.1/example/CMakeLists.txt patched/example/CMakeLists.txt
--- cmocka-1.1.1/example/CMakeLists.txt	2018-08-25 22:13:02.393732017 +0200
+++ patched/example/CMakeLists.txt	2018-08-25 22:14:20.245142615 +0200
@@ -32,7 +32,7 @@
 add_executable(simple_test simple_test.c)
 target_link_libraries(simple_test ${CMOCKA_SHARED_LIBRARY})
 
-add_test(simple_test ${CMAKE_CURRENT_BINARY_DIR}/simple_test${CMAKE_EXECUTABLE_SUFFIX})
+add_test(simple_test ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/simple_test${CMAKE_EXECUTABLE_SUFFIX})
 if (WIN32 OR CYGWIN OR MINGW)
     set_tests_properties(simple_test PROPERTIES ENVIRONMENT "PATH=${DLL_PATH_ENV}")
 endif (WIN32 OR CYGWIN OR MINGW)
@@ -41,7 +41,7 @@
 #TODO investigate dll jmp issue on MinGW
 if (NOT MINGW OR WITH_STATIC_LIB)
     add_executable(calculator_test calculator.c calculator_test.c)
-    add_test(calculator_test ${CMAKE_CURRENT_BINARY_DIR}/calculator_test${CMAKE_EXECUTABLE_SUFFIX})
+    add_test(calculator_test ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/calculator_test${CMAKE_EXECUTABLE_SUFFIX})
     if (WIN32 OR CYGWIN)
         set_tests_properties(calculator_test PROPERTIES ENVIRONMENT "PATH=${DLL_PATH_ENV}")
     endif (WIN32 OR CYGWIN)
@@ -62,7 +62,7 @@
 target_link_libraries(allocate_module_test ${CMOCKA_SHARED_LIBRARY})
 
 # This is a test that should detect leaks and overflows and will fail for that
-add_test(allocate_module_test ${CMAKE_CURRENT_BINARY_DIR}/allocate_module_test${CMAKE_EXECUTABLE_SUFFIX})
+add_test(allocate_module_test ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/allocate_module_test${CMAKE_EXECUTABLE_SUFFIX})
 if (WIN32 OR CYGWIN OR MINGW)
     set_tests_properties(allocate_module_test PROPERTIES ENVIRONMENT "PATH=${DLL_PATH_ENV}")
 endif (WIN32 OR CYGWIN OR MINGW)
@@ -77,7 +77,7 @@
 add_executable(assert_macro_test assert_macro.c assert_macro_test.c)
 target_link_libraries(assert_macro_test ${CMOCKA_SHARED_LIBRARY})
 
-add_test(assert_macro_test ${CMAKE_CURRENT_BINARY_DIR}/assert_macro_test${CMAKE_EXECUTABLE_SUFFIX})
+add_test(assert_macro_test ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/assert_macro_test${CMAKE_EXECUTABLE_SUFFIX})
 set_tests_properties(
     assert_macro_test
         PROPERTIES
@@ -91,7 +91,7 @@
 add_executable(assert_module_test assert_module.c assert_module_test.c)
 target_link_libraries(assert_module_test ${CMOCKA_SHARED_LIBRARY})
 
-add_test(assert_module_test ${CMAKE_CURRENT_BINARY_DIR}/assert_module_test${CMAKE_EXECUTABLE_SUFFIX})
+add_test(assert_module_test ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/assert_module_test${CMAKE_EXECUTABLE_SUFFIX})
 set_tests_properties(
     assert_module_test
         PROPERTIES
@@ -105,7 +105,7 @@
 add_executable(customer_database_test customer_database.c customer_database_test.c)
 target_link_libraries(customer_database_test ${CMOCKA_SHARED_LIBRARY})
 
-add_test(customer_database_test ${CMAKE_CURRENT_BINARY_DIR}/customer_database_test${CMAKE_EXECUTABLE_SUFFIX})
+add_test(customer_database_test ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/customer_database_test${CMAKE_EXECUTABLE_SUFFIX})
 if (WIN32 OR CYGWIN OR MINGW)
     set_tests_properties(customer_database_test PROPERTIES ENVIRONMENT "PATH=${DLL_PATH_ENV}")
 endif (WIN32 OR CYGWIN OR MINGW)
@@ -114,7 +114,7 @@
 add_executable(key_value_test key_value.c key_value_test.c)
 target_link_libraries(key_value_test ${CMOCKA_SHARED_LIBRARY})
 
-add_test(key_value_test ${CMAKE_CURRENT_BINARY_DIR}/key_value_test${CMAKE_EXECUTABLE_SUFFIX})
+add_test(key_value_test ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/key_value_test${CMAKE_EXECUTABLE_SUFFIX})
 if (WIN32 OR CYGWIN OR MINGW)
     set_tests_properties(key_value_test PROPERTIES ENVIRONMENT "PATH=${DLL_PATH_ENV}")
 endif (WIN32 OR CYGWIN OR MINGW)
@@ -123,7 +123,7 @@
 add_executable(product_database_test product_database.c product_database_test.c)
 target_link_libraries(product_database_test ${CMOCKA_SHARED_LIBRARY})
 
-add_test(product_database_test ${CMAKE_CURRENT_BINARY_DIR}/product_database_test${CMAKE_EXECUTABLE_SUFFIX})
+add_test(product_database_test ${CMAKE_CROSSCOMPILING_EMULATOR} ${CMAKE_CURRENT_BINARY_DIR}/product_database_test${CMAKE_EXECUTABLE_SUFFIX})
 set_tests_properties(
     product_database_test
         PROPERTIES
diff -ruN cmocka-1.1.1/tests/CMakeLists.txt patched/tests/CMakeLists.txt
--- cmocka-1.1.1/tests/CMakeLists.txt	2018-08-25 22:13:02.393732017 +0200
+++ patched/tests/CMakeLists.txt	2018-08-25 22:14:20.245142615 +0200
@@ -105,7 +105,7 @@
         1
 )
 
-add_test (test_setup_fail_1_failed test_setup_fail${CMAKE_EXECUTABLE_SUFFIX})
+add_test (test_setup_fail_1_failed ${CMAKE_CROSSCOMPILING_EMULATOR} test_setup_fail${CMAKE_EXECUTABLE_SUFFIX})
 set_tests_properties(
     test_setup_fail_1_failed
         PROPERTIES
@@ -113,7 +113,7 @@
         "\\[  ERROR   \\] int_test_ignored"
 )
 
-add_test (test_setup_fail_1_passed test_setup_fail${CMAKE_EXECUTABLE_SUFFIX})
+add_test (test_setup_fail_1_passed ${CMAKE_CROSSCOMPILING_EMULATOR} test_setup_fail${CMAKE_EXECUTABLE_SUFFIX})
 set_tests_properties(
     test_setup_fail_1_passed
         PROPERTIES
@@ -121,7 +121,7 @@
         "\\[  PASSED  \\] 1 test\\(s\\)."
 )
 
-add_test (test_setup_fail_match_failed test_setup_fail${CMAKE_EXECUTABLE_SUFFIX})
+add_test (test_setup_fail_match_failed ${CMAKE_CROSSCOMPILING_EMULATOR} test_setup_fail${CMAKE_EXECUTABLE_SUFFIX})
 set_tests_properties(
     test_setup_fail_match_failed
         PROPERTIES
@@ -129,7 +129,7 @@
         "\\[  ERROR   \\] int_test_ignored"
 )
 
-add_test (test_setup_fail_match_passed test_setup_fail${CMAKE_EXECUTABLE_SUFFIX})
+add_test (test_setup_fail_match_passed ${CMAKE_CROSSCOMPILING_EMULATOR} test_setup_fail${CMAKE_EXECUTABLE_SUFFIX})
 set_tests_properties(
     test_setup_fail_match_passed
         PROPERTIES
@@ -215,7 +215,7 @@
 foreach(_TEST_OUTPUT_FMT ${TEST_OUTPUT_FMTS})
     foreach(_OUTPUT_TEST ${OUTPUT_TESTS})
         set(TEST_NAME ${_OUTPUT_TEST}_${_TEST_OUTPUT_FMT})
-        add_test(${TEST_NAME} ${_OUTPUT_TEST}${CMAKE_EXECUTABLE_SUFFIX})
+        add_test(${TEST_NAME} ${CMAKE_CROSSCOMPILING_EMULATOR} ${_OUTPUT_TEST}${CMAKE_EXECUTABLE_SUFFIX})
 
         set_property(
             TEST
