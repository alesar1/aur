Description: use Debian gems instead of upstream's embedded code copies
 Upstream ships Sonic Pi for Win, OS X and Raspbian and distributes all
 gems needed by the ruby server within the app/server/vendor/ directory
 in the source tarball. Debian wants packagers not to use these embedded
 code copies, but to use Debian's packaged ruby gems instead. This
 patch removes the code that added the vendor/ directory to the ruby
 library path. Do note that many of the gems provided by upstream
 aren't actually used in Sonic Pi, see
 <URL: https://github.com/samaaron/sonic-pi/issues/928> for details.
Forwarded: no
Author: Hanno Zulla <kontakt@hanno.de>
Last-Update: 2016-01-22

Index: sonic-pi/app/server/core.rb
===================================================================
--- sonic-pi.orig/app/server/core.rb	2016-11-03 16:25:13.000000000 +0100
+++ sonic-pi/app/server/core.rb	2016-11-21 13:24:41.233722754 +0100
@@ -12,20 +12,8 @@
 # notice is included.
 #++
 
-## This core file sets up the load path and applies any necessary monkeypatches.
-
-## Ensure native lib dir is available
-require 'rbconfig'
-ruby_api = RbConfig::CONFIG['ruby_version']
-
-
-## Ensure all libs in vendor directory are available
-Dir["#{File.expand_path("../vendor", __FILE__)}/*/lib/"].each do |vendor_lib|
-  $:.unshift vendor_lib
-end
-
 begin
-  require 'did_you_mean'
+  require 'did_you_mean'  if RUBY_VERSION >= "2.3.0"
 rescue LoadError
   warn "Non-critical error: Could not load did_you_mean"
 end
@@ -33,43 +21,6 @@
 require 'hamster/vector'
 require 'wavefile'
 
-os = case RUBY_PLATFORM
-     when /.*arm.*-linux.*/
-       :raspberry
-     when /.*linux.*/
-       :linux
-     when /.*darwin.*/
-       :osx
-     when /.*mingw.*/
-       :windows
-     else
-       RUBY_PLATFORM
-     end
-
-# special case for proctable lib
-sys_proctable_os = case os
-                   when :raspberry
-                     "linux"
-                   when :linux
-                     "linux"
-                   when :windows
-                     "windows"
-                   when :osx
-                     "darwin"
-                   end
-$:.unshift "#{File.expand_path("../vendor", __FILE__)}/sys-proctable-1.1.1/lib/#{sys_proctable_os}"
-
-
-$:.unshift "#{File.expand_path("../rb-native", __FILE__)}/#{os}/#{ruby_api}/"
-
-require 'win32/process' if os == :windows
-
-## Add aubio native library to ENV if not present (the aubio library needs to be told the location)
-native_lib_path = "#{File.expand_path("../native/#{os}/", __FILE__)}"
-ENV["AUBIO_LIB"] ||= Dir[native_lib_path + "/lib/libaubio*.{*dylib,so*,dll}"].first
-
-
-
 # Backport Ruby 2+ thread local variable syntax
 if RUBY_VERSION < "2"
   class Thread
