From e6841dc63d0fa1a4e15fd5396ec993368e8c9f9d Mon Sep 17 00:00:00 2001
From: Nickolay Olshevsky <o.nickolay@gmail.com>
Date: Fri, 13 Aug 2021 14:37:44 +0300
Subject: [PATCH] Update version.cmake to not require Git.

---
 cmake/version.cmake | 11 +----------
 1 file changed, 1 insertion(+), 10 deletions(-)

diff --git a/cmake/version.cmake b/cmake/version.cmake
index 0ed123b52..f74126e38 100644
--- a/cmake/version.cmake
+++ b/cmake/version.cmake
@@ -37,15 +37,6 @@ macro(_git var)
   )
 endmacro()
 
-# call git, store output in var (can not fail)
-macro(git var)
-  _git(${var} ${ARGN})
-  if (NOT _git_ec EQUAL 0)
-    string(REPLACE ";" " " args "${ARGN}")
-    message(FATAL_ERROR "Failed to execute: git ${args}")
-  endif()
-endmacro()
-
 function(extract_version_info version var_prefix)
   # extract the main components
   #   v1.9.0-3-g5b92266+1546836556
@@ -91,7 +82,7 @@ function(determine_version source_dir var_prefix)
     message(STATUS "Found no version.txt.")
   endif()
   # for GIT_EXECUTABLE
-  find_package(Git REQUIRED)
+  find_package(Git)
   # get a description of the version, something like:
   #   v1.9.1-0-g38ffe82        (a tagged release)
   #   v1.9.1-0-g38ffe82-dirty  (a tagged release with local modifications)
