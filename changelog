Proton-5.9-GE-3-ST

GloriousEggroll released this Jul 6, 2020

After ironing out a lot of the major bugs since 5.11, I've realized that while some games run well enough without esync/fsync, the majority of games, specifically triple A titles, really need esync/fsync, especially when running on lower end hardware.

SO, what I've done is taken -all- of the fixes from the 5.11 versions and upstream that are major/relevant that I could recall, and backported them to the 5.9 build. This returns esync/fsync functionality, and also enables some games to run correctly that weren't running in 5.11.

So yes, this is aimed as a 'STABLE' build.
-All the fixes from the 5.11 releases.
-esync/fsync re-enabled
-MGS: Ground Zeroes fully works
-Planet Zoo fully works

From here I've created yet another branch -- proton-ge-5-stable, which I hope to backport future fixes to, and bump up once Wine gets all of its current kinks resolved. The proton-ge-5-MF branch will continue to be the upstream git branch, with major game fixes being backported to the stable branch (hopefully).

I would say for now, use this as the default 'GE' build over the 5.11 builds.


Proton-5.11-GE-3-MF

GloriousEggroll released this Jul 4, 2020

Fixes:
-Re-enable rawinput (seems staging had it disabled in the previous build)
-Re-enable FakeDLLs and SECCOMP (seems staging had it disabled in the previous build) - needed for Doom Eternal,Detroit:BH, Origin
-Re-enable HideWineExports (seems staging had it disabled in the previous build) - needed for FFXIV
-Fix issue with not being able to regain focus after alt+tab in various games
-Fix issue with GTA V keyboard input not working
-Fix issue with rawinput not working properly within a virtual desktop
-Fix issue with Warframe and SWTOR not rendering correctly in dxvk on nvidia
-Added patch that allows Indiana Jones and the Emperor's Tomb to run
-Added patch that allows MGS: Ground Zeroes to run (keyboard+mouse input is currently broken, needs more work. Works with controller)
-Added workaround for Warframe launcher rendering all black in wined3d mode (game still crashes in wined3d) - Thanks Iglu47
-README has been overhauled. Thank you TheEvilSkeleton!

Proton-5.11-GE-2-MF

GloriousEggroll released this Jun 29, 2020

This is a minor hotfix/stability release:

-Fixed issue with steam overlay causing mouse lag after 30+ minutes (issue present since 5.9, was missing from rawinput patches)
-Fixed issue with mouse hitting 'invisible walls' (issue present since 5.9, was missing from rawinput patches)
-Fixed issue with prefixes not generating properly causing some games not to be able to save due to the recent user name changes
-Ashes of the Singularity now works, vulkan renderer does not. Need to use DX11/12
-Jurassic World: Evolution now works

NOTE: If you want to allow your save games to work when using proton within lutris, you need to set WINEUSERNAME environment variable
NOTE: If you want proton's media foundation to work in lutris, you need to set GST_PLUGIN_SYSTEM_PATH_1_0 and WINE_GST_REGISTRY_DIR environment variables.


Proton-5.11-GE-1-MF

GloriousEggroll released this Jun 26, 2020

Game fixes:
-Origin 5.11 hang fixed
-Origin fixes ported from Proton 5.0.9
-Path of Exile Vulkan Renderer in-game swap fixed (for radv you will need mesa-git for upstream graphical glitch fixes)
-StarCitizen hang fixed
-Divinity Original Sin 2 hang fixed
-Mount and Blade: Bannerlord launcher fix added
-Persona 4 protonfixes fixed (thanks Pobega)
-Warframe launcher download hang fixed (broke in 5.10, still does not show progress bar)
-Sea of Thieves proper websockets implementation patches added (no longer needs win7)
-Partial fix for Catherine -- game now opens and can reach menus. Hangs on new game, waiting on EVR implementation in wine
-Deep Rock Galactic (and other games) libffi dependency fixed that was causing various crashes -- note, please do not use steam-native if you are on arch, steam-runtime should always be used.
-Protonfixes added for Assetto Corsa, should now work OOTB

Build additions:
-'wmp9_x86_64' winetricks verb imported to protonfixes from upstream winetricks that allows wmp9 to be installed in 64 bit prefixes
-hotfix added to use normal username instead of 'steamuser' when run with non-steam games. This also seems to fix issues with origin and other platforms not being able to save game (such as running Jedi Fallen Order origin version in lutris with proton)
-vkd3d updated
-dxvk updated
-FAudio updated

Build removals:
-Temporary removal of fshack, currently breaks MK11
-Temporary removal of esync, 5.10+ did a large rework of ntdll which broke compatibility with esync. The patchset needs to be rebased. It is currently disabled in staging.
-Temporary removal of fsync - fsync relies on esync. No esync = no fsync.

Known issues but playable:
-MK11 - no audio in custscenes -- needs SAR fixes, online matches broken
-Injustice 2 - no audio in custscenes -- needs SAR fixes
-Broken sound in Borderlands 3 Marcus new game intro -- can be skipped.
-Age of Empires II WMV videos don't play
-Street Fighter V intro videos don't play

Still broken:
-Seven (hangs on new game)
-Catherine (hangs on new game)
-Soul Calibur VI (hangs at main menu, needs SAR fixes)
-Nioh videos don't play, gameplay untested

Marking this as release as it has a lot of regression fixes and should be quite stable, despite the ongoing media foundation work and esync/fsync being disabled.


Proton-5.9-GE-2-MF

GloriousEggroll released this Jun 06, 2020

--HOTFIX--
6/10/2020 7:17 PM MST:
After reviewing the issue tracker again for Sea of Thieves I found via ga2mer's comments that it becomes working/playable after login if the prefix is set to Win7. I tested this and it did indeed allow me to login and get past the previous journal issue/became playable. I've added a hotfix in protonfixes that should do this automagically. Updated Proton-5.9-GE-2-MF.tar.gz again.
--HOTFIX--
6/10/2020 10:15 AM MST:
I accidentally applied part 1 of a 2 part patch for RE3 twice instead of both 1st and 2nd parts, so I just corrected that and recompiled + reattached Proton-5.9-GE-2-MF.tar.gz. RE3 credits should work now

Hi all, I'm marking this as another pre-release as we still have some audio issues with media foundation, and a few other pending issues, however we also have quite a few fixes:

-Fullscreen hack is disabled still for compatibility with MK11.
-Rawinput re-enabled
-Nier/sekiro winex11 patch re-enabled
-winevulkan patches re-enabled
-The weird Skyrim mouse reverse input issue was fixed in 5.10, so I've backported it.
-There is some heavy work being done on wined3d and dxgi, which causes some additional issues, so TOXIKK and Killer Instinct require wined3d to currently run properly. Protonfixes have been added to do that automatically, so those games both work with wined3d currently.
-There is also some heavy work being done on ntdll in 5.10+, which cause esync and fsync patchsets to not be compatible. Due to this, I'm currently working with 5.9 and backporting specific changes necessary to retain esync and fsync compatibility.
-A dxgi native override was also added in protonfixes so that Metal Gear Solid V: Phantom Pain now works
-A fix has been added for the RE3 credits crash - thanks vitorhnn!
-A fix has been added for the MK11 and Injustice 2 video color issue - thanks vitorhnn!
-A partial fix for websockets has been added for Sea of Thieves so that login now works, however it is currently crashing after login on 'Opening the Journal' - thanks ga2mer!
-5.10 media foundation patches have been backported
-Remi Bernon's free range memory allocation patches have been backported which increases performance in We Happy Few and some other games.
-Proton 5.0.8 changes backported
-DXVK updated
-vkd3d updated
-FAudio updated

Known issues:
-Fullscreen hack still disabled for the time being to retain compatiblity with MK11
-Path of Exile cannot switch to vulkan renderer when using RADV, but works with AMDVLK. This is something else tied to fullscreen hack, as patching in fullscreen hack allows it to switch. RADV currently has a lot of graphical glitches with PoE anyway, so for the time being AMDVLK is the better option to use.
-Soul Calibur VI still hangs at intro due to incomplete SAR work in media foundation
-Injustice 2 and MK11 cut scene audio is missing due to incomplete SAR work in media foundation
-Borderlands 3 Marcus intro on new game audio is distorted due to incomplete SAR work in media foundation, but is skippable.
-Seven still only plays intro audio, no video, and crashes after starting new game due to incomplete SAR work in media foundation.
-libffi6 is still needed for some rolling release distros such as arch
-As mentioned, due to work being done with wined3d, dxgi is in an odd state. If a game works in proton, but does not work in proton-ge, try adding WINEDLLOVERRIDES=dxgi=n %command% to the options. If it works, let me know and I can add a protonfixes override for it.

Currently I would say this should be ok to use for most games except Soul Calibur VI and Seven


Proton-5.9-GE-1-NR

GloriousEggroll released this on May 28, 2020

-Fullscreen hack was found to be the cause of Mortal Kombat 11 not working. This also requires a few other patches to be disabled such as some additional vulkan patches and raw input, as well as the Sekiro patch. Fullscreen hack used to work with this game, so this is just a temporary disable until I can figure out what in the patchset is causing MK11 to not work.
-Spyro audio is fully working now
-BL3 Markus intro has audio issues still but is skippable
-Soul Calibur VI freezes at the intro screen currently due to an issue with SAR audio.
-Seven actually launches now. Audio for intro movie plays but shows black screen. New game results in crash, again due to SAR audio.
-PC Building Simulator no longer freezes when running 3dmark on low settings. It just skips the video.


Proton-5.8-GE-2-MF

GloriousEggroll released this on May 13, 2020

This is an update to 5.8-GE-1 in regards to media foundation work:

Completed:
-RE3: Bathroom scene fixed
-Dangonronpa v3 fixed
-Power Rangers Battle for the grid chipmunk voices fixed
-Monster Hunter World tutorial movies fixed
-Super Lucky's Tale -- Fixed an issue with bink videos not playing in GE builds which work in proton

WIP (work in progress):
Borderlands 3 Marcus intro video
Darksiders Warmastered Edition opening videos play now play, but New Game movie crashes
Street Fighter V intro videos don't play
Seven intro videos don't play

Todo:
-Age of Empires II WMV videos don't play - check if MF or quartz
-Catherine Classic does not play, opens small black box for game window - check if MF or quartz
-Nioh videos don't play - check if MF or quartz


Proton-5.8-GE-1-MF

GloriousEggroll released this May 10, 2020

Overall fixes:
-Fix for ValveSoftware#2929 added, fixes crash in Dark Souls 3, Sekiro, Nier: Automata
-GTA IV should be fully playable now, patches imported from upstream proton
-Street Fighter V should be fully playable now, patches imported from upstream proton
-HideWineExports=Y registration added for FFXIV, fixes license issue
-Homeworld Remastered Collection should be playable without custom launcher necessary
-Updated steep patch for wine 5.8
-fixed proton controller patch issues -- should now have full proton controller patchset and functionality to match upstream proton
-patch added that fixes overwatch breakage in 5.7
-patch added that fixes star citizen breakage in 5.7
-patch added that fixes Path of Exile flicker in 5.7
-FFXV patch is now working again, game should be playable
-Monster Hunter World patches added which enable DX12 mode with vkd3d
MF (Media Foundation) specific fixes:
-Resident Evil 2 videos fixed, should now be fully playable, also works in DX12/vkd3d
-Spyro Reignited Trilogy videos fixed, should now be fully playable
-Remnant: From the Ashes videos fixed, should now be fully playable
-Soul Calibur VI videos fixed, should now be fully playable
-Street Fighter V videos fixed, should now be fully playable
-Deep Rock Galactic videos fixed, should now be fully playable
-BlazBlue Centralfiction videos fixed, should now be fully playable
-Bloodstained: Ritual of the night intro videos fixed, should now be fully playable
-Crazy Machines 3 videos fixed, should now be fully playable


Proton-5.6-GE-2

GloriousEggroll released this Apr 14, 2020

-This is a hotfix that reverts the fullscreen hack changes, as they introduced a regression with mouse stutter on movement after a period of time. What this means:
-Fullscreen hack is still enabled, it's just using proton's version, not customized for staging
-Staging's winex11.drv-mouse-coorrds and rawinput patchsets have been disabled
-Proton's rawinput patchset has been re-enabled.

Normally I'd wait to release smaller changes like this, but the regression made some games basically unplayable. This should allow games to be played at least without the mouse stutter.


Proton-5.6-GE-1

GloriousEggroll released this Apr 13, 2020

This is a pre-release continuation of the mfplat work done by Guy1524 (Derek) along with some additional fixes.

Wine + Wine-staging:
-Update to 5.6 release

mfplat:
-Add partial WMV playback support (Should allow RE2 and RE3 movies to play)
-Add gst-plugins-ugly and wmv playback patch to build

protonfixes:
-Add dxgi=n override for Darksiders Warmastered Edition, game seems to crash with wine's dxgi when using dxvk
-Add Divinity Original Sin 2 symlink fix update - fixes black screen on first launch
-Add SECCOMP override for RE3, needed by Denuvo
-Add SECCOMP override for DOOM Eternal, needed by Denuvo

proton:
-Add Proton 5.0.6 alpha patches
-Add Proton 5.0.6 alpha DOOM Eternal Audio patches
-fixed build system to include dist folder directly instead of tarball. This fixes the issue with sometimes having to hit the play button twice, or some issues people have on their system where the dist tarball never extracts.
-fullscreen hack patches modified to work with staging's winex11.drv-mouse-coorrds and rawinput patch sets

Notes:
-Spyro is still broken
-MHW Tutorials are still broken
-BL3 usually wants to set Direct12, which crashes. This generally leads to a popup asking you to restore default settings (confirm/hit yes). You will then need to relaunch the game and go in the games settings and change it to DirectX11 manually. After that DirectX11 should stick as the default mode.
-RE2 Crashes in DX12 with vkd3d at main menu, you'll need to set DirectX11 in re2_config.ini for DX11 with DXVK
-RE3 Seems to work with DX12 and vkd3d with minor interface graphical glitches. Can set DirectX11 in re3_config.ini for DX11 with DXVK
-FFXV seems to be working again

Again, I must note that 'pre-release' builds are basically alpha-testing builds. While they may contain a lot of fixes, some things may also be broken that normally are not.

Specifically in this regard - proton normally disables 'mfplay' which allows media foundation movies in many games (WMV and MP4) to just be skipped automatically. Since we enable this without full functionality, some games, such as Spyro or MHW, may hang when a movie tries to play.

If you wish to re-disable media foundation to use this version with your other games, you can use WINEDLLOVERRIDES=mfplay=n %command% in the game's launch options.


Proton-5.5-GE-1

GloriousEggroll released this Apr 5, 2020

So I'd like to preface that this is a pre-release that has a massive amount of media foundation/mfplat wine patches. A huge thank you goes to Derek Lesho (Guy1524: https://github.com/Guy1524/wine) as well as Nikolay Sivov and Sergio Gómez Del Real all from CodeWeavers for getting this stuff working and taking the time to help me get it working with the correct dependencies in proton.

What this does is allows mp4 playback in MANY titles, including UE4 -and- Unity engine games. This fixes a lot (not all, but a lot) of issues surrounding media foundation/mfplat without the need for the 'mf-install' workaround that has legal issues and limitations, and is much safer for us to ship.

Tested fixes:
-Fixed borderlands 3 lilith in-head videos and 'watch the monitor' video bug
-Fixes Remnant: From the Ashes intro videos, intro menu, character menu
-Fixes intro video on Bloodstained: Ritual of the Night
-Fixes mp4 playback issues related to Crazy Machines 3

Still broken:
-Borderlands 3 intro narrative with Marcus's voice on new game does not play
-Spyro is still broken
-Probably some other mp4 related titles

Additional updates:
-A small patch has been added that should fix sunset overdrive from crashing on launch: https://source.winehq.org/patches/data/182631
-Two warframe launcher regressions have been fixed
-Mouse input fix patches which were added to wine-staging for Mount & Blade II: Bannerlord: https://bugs.winehq.org/show_bug.cgi?id=36873
-Lots of gstreamer plugin related work has been done/added in order to get media foundation stuff working. This was also cleared with aeikum and kisak from Valve personally, and deemed -ok- to include in my repository. This means it is safe to continue to link in Valve's issue trackers, unlike the 'mf-install' workaround. HURRAY!

Additional notes:
-Not -all- mp4s are fixed. There are still some that have problematic formats that are being worked on.
-Also coming down the pipe soon will be WMV playback fixes. This is to be handled after the mp4 issues are sorted.

Enjoy!


Proton-5.4-GE-3

GloriousEggroll released this Mar 25, 2020

-wine 5.4 updated to latest git which includes some fixes/updates winevulkan to 1.2.134. DOOM Eternal seems to work fine with it when not blocked by Denuvo.
-Added ValveSoftware/wine#86 for more winevulkan compatibility
-Added https://source.winehq.org/patches/data/181826 for more winevulkan compatibility
-FAudio reverted to 20.03 stable release as some audio issues were reported
-Warframe controller patch updated to strictly only take effect when warframe is running, since the issue doesn't seem to affect other games.
-proton controller patches have been disabled (again) in favor of standard wine+wine-staging's, after reports of 'ghost' input and/or periodic input loss. SDL patches are still in applied.


Proton-5.4-GE-2

GloriousEggroll released this Mar 22, 2020

This is more of a clean-up release although some new stuff/fixes have been added, mainly for DOOM Eternal

-Updated wine + staging to 5.4-git/upstream for DOOM Eternal
-Added ValveSoftware/wine#85 VK_KHR_get_surface_capabilities2 and fake support for VK_EXT_full_screen_exclusive for DOOM Eternal
-Added ValveSoftware/wine#83 which fixes some crashes in DARK SOULS III (374320), Nier: Automata (524220), Sekiro: Shadows Die Twice (814380)
-Added some missing registry entries that prevented Batman: Arkham Knight from starting on a clean prefix
-Cleaned up/removed unused mf_install verb in protonfixes in preparation for newer mfplat alpha patches (coming soon)
-Removed '-wolcen lords of mayhem 'blob head' fix' as the game devs fixed it internally per update 1.0.10.0
-Removed 'plasma systray fix' as it didn't really benefit anything, and actually interfered with some games.
-Removed Detroit:Become Human patch as it's already been upstreamed
-Cleaned up some duplicate patches and updated our current patches to work with latest wine-git+staging/git
-Updated vkd3d
-Updated dxvk
-Updated FAudio

Notes on DOOM Eternal:

    DOOM Eternal currently requires vulkan-loader/vulkan-icd-loader 1.2.135
    For AMD also requires mesa-git .
    ACO did not work for me with DOOM Eternal when I tried it, but llvm worked fine.
    To get rid of pre-launch GPU notices such as (HDR not supported), open DOOMEternal/launcherData/launcher.cfg and change all of these to 0:

rgl_showAMDStartupWarning 0
rgl_showIntelStartupWarning 0
rgl_showNvidiaStartupWarning 0


Proton-5.4-GE-1

GloriousEggroll released this Mar 16, 2020

-controller fix for warframe - allows controller profiles to be loaded only if a controller is plugged in. fixes crash if no controller plugged in after 5 min.
-vkd3d updated, allows WoW to be played using proton via lutris (disable dxvk in lutris)
-more metro exodus vkd3d fixes
-wolcen lords of mayhem 'blob head' fix
-detroit: become human patch added
-need for speed world launcher patch added
-wine+ wine-staging updated to 5.4
-dxvk updated to latest git
-faudio updated to latest git
-fixes from Proton 5.0.4 imported

Known issues:

-MHW broken since last patch.
-MK11 broken since wine 5.0
-Injustice 2 broken since wine 5.0 (did not work here, but have had it reported working in 4.21)
-Borderlands 3 does not work with vkd3d yet


Proton-5.2-GE-2

GloriousEggroll released this Feb 23, 2020

This is a pre-release to fix Fallout New Vegas from crashing on main menu.
-fixes a missing portion of the fullscreen hack
-dxvk updated
-more metro exodus vkd3d fixes
-wine 5.2 updated to latest git


Proton-5.2-GE-1

GloriousEggroll released this Feb 19, 2020

This is a pre-release to fix the Warframe Launcher bug introduced in 2/18's update.


Proton-5.1-GE-2

GloriousEggroll released this Feb 17, 2020

This is mainly a hotfix + feature release build.

Hotfix:
-Fixed warframe requiring a controller to be plugged in. That's right, you no longer need xboxdrv! I spent the weekend debugging it and was finally able to come up with a bit of a hacky workaround, but it works for now until valve addresses the issue (it has to do with the way lsteamclient handles controllers)

Feature:
-vkd3d branch is latest from codeweavers + DXIL changes by Hans Kristian (who has been doing a lot of vkd3d submissions) + metro exodus commits that both Hans and Doitsujin (creator of dxvk) have been working on together. The previous release had Hans's DXIL changes, this just adds the Metro changes on top of it. With that being said, expect some minor graphical glitches in vkd3d with Metro Exodus

Additions:
-This commit: ValveSoftware#3518 has been merged. This was a previous open PR from Guy1542, but it had a bug that would cause clustertruck and a few others not to launch. The new PR is by joshie (d9vk dev) and works now

-dxvk update to latest git
-faudio updated to latest git

Known issues:
-Just Cause 3 not able to save
-Batman Arkham Knight grappling hook not working
-MK11 hanging at launch (again)


Proton-5.1-GE-1

GloriousEggroll released this Feb 10, 2020

-added fullscreen hack rebase from proton 5
-added updated steamclient rebase from proton 5 so that jc3 and batman AK denuvo problems work
-added updated monster hunter world patch that limits the changes to monster hunter world
-added proton patch that sets prefixes to win10 by default
-added dsound surround sound patches from proton 5
-proton dxvk wine integration patches added so that vkd3d works ootb without PROTON_USE_WINED3D
-reenabled proton's gamepad changes in favor over staging's (for now. let me know in discord if issues occur)
-updated to include proton's gstreamer and glib integration work
-added plasma systray patch
-fixed proton compatibility for staging patchset winex11.drv-mouse-coorrds
-disabled winex11-_NET_ACTIVE_WINDOW temporarily (not working correctly)
-disabled winex11-WM_WINDOWPOSCHANGING temporarily (depends on winex11-_NET_ACTIVE_WINDOW)
-updated dxvk to 1.5.4 official
-updated FAudio
-updated vkd3d

Known issues:
-Just Cause 3 not able to save
-Please note, vkd3d is very new and still does not work for DirectX 12 on all games.


Proton-5.0-GE-1

GloriousEggroll released this Jan 30, 2020

-fixed issue with uplay games not recognizing they were being launched from steam
-fixed issue with farcry 5 hanging at launch
-fixed issue with stuttering in various games introduced by staging's ntdll-ForceBottomUpAlloc patches (darksiders 3, farcry 5)
-raw input patches finally fixed and enabled
-fixed issue with the MK11/skyrim skyui patch trying to allocate 119t virtual memory
-added patches that allow For Honor and steep to launch and work in single-player mode
-added patch that fixes battlenet beta crashing with win10 set in winecfg
-added patch that fixes fullscreen mode in steep
-added patch that fixes performance regression in Monster Hunter World caused by Iceborn DLC release.
-fixed proton compatibility for staging patchset winex11-MWM_Decorations (fixes https://bugs.winehq.org/show_bug.cgi?id=42117 which affects battlenet)
-fixed proton compatibility for staging patchset winex11-_NET_ACTIVE_WINDOW (fixes https://bugs.winehq.org/show_bug.cgi?id=2155 which affects some older games and apps)
-added proton's internal wined3d dxvk integration changes
-updated dxvk
-updated faudio
-changed vkd3d repository to one regularly worked on.

Edit:
-added fix for loading hang for endless legend
-added black ops 2 launch crash fix
-added winex11-WM_WINDOWPOSCHANGING patch from staging
-fixed an issue with proton not using d3d9 override (whoopsie)

Disabled the following for now, has an issue that causes windows to open and immediately close:
-proton compatibility for staging patchset winex11.drv-mouse-coorrds (fixes https://bugs.winehq.org/show_bug.cgi?id=46309 which affects origin)
