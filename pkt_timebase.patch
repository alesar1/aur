From 2da109684a662a51989aa581bfc6cd1888f6c68c Mon Sep 17 00:00:00 2001
From: Ilkka Ollakka <ileoo@videolan.org>
Date: Fri, 18 Jun 2021 10:23:35 +0300
Subject: [PATCH] avcodec/subtitle: stop using removed setter for pkt timebase
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Removed from ffmpeg repo in commit 23bb78d2ea4f0e3a0835744d59708efed50abccc.

(cherry picked from commit e7190e7a70e9701754c50348f5b6357759440657)
Signed-off-by: Hugo Beauz√©e-Luyssen <hugo@beauzee.fr>
---
 modules/codec/avcodec/subtitle.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/modules/codec/avcodec/subtitle.c b/modules/codec/avcodec/subtitle.c
index a17ba985e15..d3afe4270be 100644
--- a/modules/codec/avcodec/subtitle.c
+++ b/modules/codec/avcodec/subtitle.c
@@ -90,7 +90,9 @@ int InitSubtitleDec(vlc_object_t *obj)
     context->extradata_size = 0;
     context->extradata = NULL;
 
-#if LIBAVFORMAT_VERSION_MICRO >= 100
+#if LIBAVFORMAT_VERSION_MAJOR >= 59
+    context->pkt_timebase=AV_TIME_BASE_Q;
+#elif LIBAVFORMAT_VERSION_MICRO >= 100
     av_codec_set_pkt_timebase(context, AV_TIME_BASE_Q);
 #endif
 
-- 
GitLab

