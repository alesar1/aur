diff -aur Arduino-1.6.12/build/build.xml Arduino-1.6.12.new/build/build.xml
--- Arduino-1.6.12/build/build.xml	2016-09-21 12:09:37.000000000 +0200
+++ Arduino-1.6.12.new/build/build.xml	2016-10-04 00:05:43.459380000 +0200
@@ -177,29 +177,7 @@

     <mkdir dir="${target.path}/reference"/>

-    <!-- Unzip documentation -->
-    <antcall target="unzip">
-      <param name="archive_file" value="shared/reference-1.6.6-3.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/reference-1.6.6-3.zip" />
-      <param name="final_folder" value="${target.path}/reference/www.arduino.cc" />
-      <param name="dest_folder" value="${target.path}/reference/" />
-    </antcall>
-    <antcall target="unzip">
-      <param name="archive_file" value="shared/Galileo_help_files-1.6.2.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/Galileo_help_files-1.6.2.zip" />
-      <param name="final_folder" value="${target.path}/reference/Galileo_help_files" />
-      <param name="dest_folder" value="${target.path}/reference/" />
-    </antcall>
-    <antcall target="unzip">
-      <param name="archive_file" value="shared/Edison_help_files-1.6.2.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/Edison_help_files-1.6.2.zip" />
-      <param name="final_folder" value="${target.path}/reference/Edison_help_files" />
-      <param name="dest_folder" value="${target.path}/reference/" />
-    </antcall>
-
-    <!-- Fix wrong permissions from zip file root folder -->
-    <chmod perm="755" dir="${target.path}/reference/Galileo_help_files" />
-    <chmod perm="755" dir="${target.path}/reference/Edison_help_files" />
+    <antcall target="assemble-docs" />

     <!-- Write the revision file! -->
     <echo file="${target.path}/lib/version.txt" message="${version}" />
@@ -215,8 +193,35 @@
     </antcall>
   </target>

+  <target name="assemble-docs" unless="no_docs">
+      <!-- Unzip documentation -->
+      <antcall target="unzip">
+        <param name="archive_file" value="shared/reference-1.6.6-3.zip" />
+        <param name="archive_url" value="https://downloads.arduino.cc/reference-1.6.6-3.zip" />
+        <param name="final_folder" value="${target.path}/reference/www.arduino.cc" />
+        <param name="dest_folder" value="${target.path}/reference/" />
+      </antcall>
+      <antcall target="unzip">
+        <param name="archive_file" value="shared/Galileo_help_files-1.6.2.zip" />
+        <param name="archive_url" value="https://downloads.arduino.cc/Galileo_help_files-1.6.2.zip" />
+        <param name="final_folder" value="${target.path}/reference/Galileo_help_files" />
+        <param name="dest_folder" value="${target.path}/reference/" />
+      </antcall>
+      <antcall target="unzip">
+        <param name="archive_file" value="shared/Edison_help_files-1.6.2.zip" />
+        <param name="archive_url" value="https://downloads.arduino.cc/Edison_help_files-1.6.2.zip" />
+        <param name="final_folder" value="${target.path}/reference/Edison_help_files" />
+        <param name="dest_folder" value="${target.path}/reference/" />
+      </antcall>
+
+      <!-- Fix wrong permissions from zip file root folder -->
+      <chmod perm="755" dir="${target.path}/reference/Galileo_help_files" />
+      <chmod perm="755" dir="${target.path}/reference/Edison_help_files" />
+  </target>
+
   <!-- copy library folder -->
-  <target name="assemble-libraries" unless="light_bundle">
+  <target name="assemble-libraries" depends="assemble-libraries-full, assemble-libraries-light" />
+  <target name="assemble-libraries-full" unless="light_bundle">
     <copy todir="${target.path}/libraries">
       <fileset dir="../libraries"/>
     </copy>
@@ -232,6 +237,9 @@
     <download-library name="Mouse" version="1.0.1"/>
     <download-library name="Keyboard" version="1.0.1"/>
   </target>
+  <target name="assemble-libraries-light" if="light_bundle">
+    <mkdir dir="${target.path}/libraries" />
+  </target>

   <macrodef name="download-library">
     <attribute name="name"/>
@@ -250,13 +258,17 @@
   </macrodef>

   <!-- copy hardware folder -->
-  <target name="assemble-hardware" unless="light_bundle">
+  <target name="assemble-hardware" depends="assemble-hardware-full, assemble-hardware-light" />
+  <target name="assemble-hardware-full" unless="light_bundle">
     <copy todir="${target.path}/hardware">
       <fileset dir="../hardware">
         <exclude name="arduino/sam/**"/>
       </fileset>
     </copy>
   </target>
+  <target name="assemble-hardware-light" if="light_bundle">
+    <copy file="../hardware/package_index_bundled.json" todir="${target.path}/hardware" />
+  </target>

   <!-- - - - - - - - - -->
   <!-- Revision check  -->
@@ -362,7 +374,7 @@

     <antcall target="unzip">
       <param name="archive_file" value="${staging_folder}/appbundler-1.0ea-arduino4.jar.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/appbundler-1.0ea-arduino4.jar.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/appbundler-1.0ea-arduino4.jar.zip" />
       <param name="final_folder" value="${staging_folder}/appbundler-1.0ea-arduino4" />
       <param name="dest_folder" value="${staging_folder}/appbundler-1.0ea-arduino4" />
     </antcall>
@@ -447,7 +459,7 @@

     <antcall target="unzip">
       <param name="archive_file" value="./libastylej-2.05.1-3.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/libastylej-2.05.1-3.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/libastylej-2.05.1-3.zip" />
       <param name="final_folder" value="${staging_folder}/libastylej-2.05.1" />
       <param name="dest_folder" value="${staging_folder}" />
     </antcall>
@@ -458,7 +470,7 @@

     <antcall target="unzip">
       <param name="archive_file" value="./liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/liblistSerials/liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/liblistSerials/liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
       <param name="final_folder" value="${staging_folder}/liblistSerials-${LIBLISTSERIAL-VERSION}" />
       <param name="dest_folder" value="${staging_folder}" />
     </antcall>
@@ -469,7 +481,7 @@
     <mkdir dir="${staging_folder}/arduino-builder-macosx"/>
     <antcall target="untar">
       <param name="archive_file" value="./arduino-builder-macosx-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
-      <param name="archive_url" value="http://downloads.arduino.cc/tools/arduino-builder-macosx-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
+      <param name="archive_url" value="https://downloads.arduino.cc/tools/arduino-builder-macosx-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
       <param name="final_folder" value="${staging_folder}/arduino-builder-macosx/arduino-builder" />
       <param name="dest_folder" value="${staging_folder}/arduino-builder-macosx" />
     </antcall>
@@ -645,7 +657,7 @@
   <target name="linux-libastyle-x86" depends="linux-build" description="Download libastyle.so for x86/x64 arch">
     <antcall target="unzip">
       <param name="archive_file" value="./libastylej-2.05.1-3.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/libastylej-2.05.1-3.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/libastylej-2.05.1-3.zip" />
       <param name="final_folder" value="${staging_folder}/libastylej-2.05.1" />
       <param name="dest_folder" value="${staging_folder}" />
     </antcall>
@@ -658,7 +670,7 @@

     <antcall target="unzip">
       <param name="archive_file" value="./liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/liblistSerials/liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/liblistSerials/liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
       <param name="final_folder" value="${staging_folder}/liblistSerials-${LIBLISTSERIAL-VERSION}" />
       <param name="dest_folder" value="${staging_folder}" />
     </antcall>
@@ -670,7 +682,7 @@
   <target name="linux-libastyle-arm" depends="linux-build" description="Download libastyle.so for ARM">
     <antcall target="unzip">
       <param name="archive_file" value="./libastylej-2.05.1-3.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/libastylej-2.05.1-3.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/libastylej-2.05.1-3.zip" />
       <param name="final_folder" value="${staging_folder}/libastylej-2.05.1" />
       <param name="dest_folder" value="${staging_folder}" />
     </antcall>
@@ -683,7 +695,7 @@

     <antcall target="unzip">
       <param name="archive_file" value="./liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/liblistSerials/liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/liblistSerials/liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
       <param name="final_folder" value="${staging_folder}/liblistSerials-${LIBLISTSERIAL-VERSION}" />
       <param name="dest_folder" value="${staging_folder}" />
     </antcall>
@@ -701,7 +713,7 @@
     <mkdir dir="${staging_folder}/arduino-builder-arm"/>
     <antcall target="untar">
       <param name="archive_file" value="./arduino-builder-arm-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
-      <param name="archive_url" value="http://downloads.arduino.cc/tools/arduino-builder-arm-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
+      <param name="archive_url" value="https://downloads.arduino.cc/tools/arduino-builder-arm-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
       <param name="final_folder" value="${staging_folder}/arduino-builder-arm/arduino-builder" />
       <param name="dest_folder" value="${staging_folder}/arduino-builder-arm" />
     </antcall>
@@ -731,7 +743,7 @@
     <mkdir dir="${staging_folder}/arduino-builder-linux32"/>
     <antcall target="untar">
       <param name="archive_file" value="./arduino-builder-linux32-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
-      <param name="archive_url" value="http://downloads.arduino.cc/tools/arduino-builder-linux32-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
+      <param name="archive_url" value="https://downloads.arduino.cc/tools/arduino-builder-linux32-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
       <param name="final_folder" value="${staging_folder}/arduino-builder-linux32/arduino-builder" />
       <param name="dest_folder" value="${staging_folder}/arduino-builder-linux32" />
     </antcall>
@@ -761,7 +773,7 @@
     <mkdir dir="${staging_folder}/arduino-builder-linux64"/>
     <antcall target="untar">
       <param name="archive_file" value="./arduino-builder-linux64-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
-      <param name="archive_url" value="http://downloads.arduino.cc/tools/arduino-builder-linux64-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
+      <param name="archive_url" value="https://downloads.arduino.cc/tools/arduino-builder-linux64-${ARDUINO-BUILDER-VERSION}.tar.bz2" />
       <param name="final_folder" value="${staging_folder}/arduino-builder-linux64/arduino-builder" />
       <param name="dest_folder" value="${staging_folder}/arduino-builder-linux64" />
     </antcall>
@@ -822,8 +834,21 @@

   <!-- Retrieve tool -->
   <target name="untar-unzip-download" depends="untar-unzip-check" unless="${archive_file}_available">
+      <antcall target="untar-unzip-download-web" />
+      <antcall target="untar-unzip-download-local" />
+  </target>
+  <target name="untar-unzip-download-web" unless="local_sources">
     <get src="${archive_url}" dest="${archive_file}" verbose="true" ignoreerrors="true" />
   </target>
+  <target name="untar-unzip-download-local" if="local_sources">
+    <basename file="${archive_file}" property="basename" />
+    <echo>Skipping download of ${archive_url}, using makepkg downloaded ${basename}</echo>
+    <exec executable="ln" failonerror="true">
+        <arg value="-s" />
+        <arg value="${basedir}/../../${basename}" />
+        <arg value="${archive_file}" />
+    </exec>
+  </target>

   <target name="untar-unzip-checksum" depends="untar-unzip-download">
     <echo>Testing checksum of "${archive_file}"</echo>
@@ -926,7 +951,7 @@
   <target name="download-launch4j-windows">
     <antcall target="unzip-with-ant-task">
       <param name="archive_file" value="windows/launch4j-3.8-win32.zip"/>
-      <param name="archive_url" value="http://downloads.sourceforge.net/project/launch4j/launch4j-3/3.8/launch4j-3.8-win32.zip"/>
+      <param name="archive_url" value="https://downloads.sourceforge.net/project/launch4j/launch4j-3/3.8/launch4j-3.8-win32.zip"/>
       <param name="final_folder" value="windows/launcher/launch4j"/>
       <param name="dest_folder" value="windows/launcher/"/>
     </antcall>
@@ -935,7 +960,7 @@
   <target name="download-launch4j-linux">
     <antcall target="untar">
       <param name="archive_file" value="windows/launch4j-3.8-linux.tgz"/>
-      <param name="archive_url" value="http://downloads.sourceforge.net/project/launch4j/launch4j-3/3.8/launch4j-3.8-linux.tgz"/>
+      <param name="archive_url" value="https://downloads.sourceforge.net/project/launch4j/launch4j-3/3.8/launch4j-3.8-linux.tgz"/>
       <param name="final_folder" value="windows/launcher/launch4j"/>
       <param name="dest_folder" value="windows/launcher/"/>
     </antcall>
@@ -977,7 +1002,7 @@

     <antcall target="unzip">
       <param name="archive_file" value="./libastylej-2.05.1-3.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/libastylej-2.05.1-3.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/libastylej-2.05.1-3.zip" />
       <param name="final_folder" value="${staging_folder}/libastylej-2.05.1" />
       <param name="dest_folder" value="${staging_folder}" />
     </antcall>
@@ -987,7 +1012,7 @@

     <antcall target="unzip">
       <param name="archive_file" value="./liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/liblistSerials/liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/liblistSerials/liblistSerials-${LIBLISTSERIAL-VERSION}.zip" />
       <param name="final_folder" value="${staging_folder}/liblistSerials-${LIBLISTSERIAL-VERSION}" />
       <param name="dest_folder" value="${staging_folder}" />
     </antcall>
@@ -998,7 +1023,7 @@
     <mkdir dir="${staging_folder}/arduino-builder-windows"/>
     <antcall target="unzip-with-ant-task">
       <param name="archive_file" value="./arduino-builder-windows-${ARDUINO-BUILDER-VERSION}.zip" />
-      <param name="archive_url" value="http://downloads.arduino.cc/tools/arduino-builder-windows-${ARDUINO-BUILDER-VERSION}.zip" />
+      <param name="archive_url" value="https://downloads.arduino.cc/tools/arduino-builder-windows-${ARDUINO-BUILDER-VERSION}.zip" />
       <param name="final_folder" value="${staging_folder}/arduino-builder-windows/arduino-builder.exe" />
       <param name="dest_folder" value="${staging_folder}/arduino-builder-windows" />
     </antcall>
@@ -1131,12 +1156,12 @@
   </target>

   <target name="avr-toolchain-bundle" unless="light_bundle">
-    <!-- Unzip AVR tools -->
+    <!--
     <mkdir dir="${staging_folder}/work/${staging_hardware_folder}/tmp/gcc"/>

     <antcall target="${unpack_target}">
       <param name="archive_file" value="${staging_folder}/${gcc_archive_file}"/>
-      <param name="archive_url" value="http://downloads.arduino.cc/tools/${gcc_archive_file}"/>
+      <param name="archive_url" value="https://downloads.arduino.cc/tools/${gcc_archive_file}"/>
       <param name="final_folder" value="${staging_folder}/work/${staging_hardware_folder}/tmp/gcc/${gcc_version}/"/>
       <param name="dest_folder" value="${staging_folder}/work/${staging_hardware_folder}/tmp/gcc/"/>
     </antcall>
@@ -1145,7 +1170,7 @@

     <antcall target="${unpack_target}">
       <param name="archive_file" value="${staging_folder}/${avrdude_archive_file}"/>
-      <param name="archive_url" value="http://downloads.arduino.cc/tools/${avrdude_archive_file}"/>
+      <param name="archive_url" value="https://downloads.arduino.cc/tools/${avrdude_archive_file}"/>
       <param name="final_folder" value="${staging_folder}/work/${staging_hardware_folder}/tmp/avrdude/${avrdude_version}"/>
       <param name="dest_folder" value="${staging_folder}/work/${staging_hardware_folder}/tmp/avrdude/"/>
     </antcall>
@@ -1157,6 +1182,7 @@
     <echo append="true" file="${staging_folder}/work/${staging_hardware_folder}/tools/avr/builtin_tools_versions.txt" message="arduino.avr-gcc=${gcc_version}${line.separator}"/>

     <delete dir="${staging_folder}/work/${staging_hardware_folder}/tmp"/>
+    -->
   </target>

   <target name="generate-hourly-build-txt" if="hourly">
