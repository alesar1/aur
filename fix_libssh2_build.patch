diff --git a/src/openssl.h b/src/openssl.h
index 6aa1219..f393c9c 100644
--- a/src/openssl.h
+++ b/src/openssl.h
@@ -223,7 +223,7 @@ int _libssh2_md5_init(libssh2_md5_ctx *ctx);
 #define libssh2_hmac_update(ctx, data, datalen) \
   HMAC_Update(&(ctx), data, datalen)
 #define libssh2_hmac_final(ctx, data) HMAC_Final(&(ctx), data, NULL)
-#define libssh2_hmac_cleanup(ctx) HMAC_cleanup(ctx)
+#define libssh2_hmac_cleanup(ctx) HMAC_CTX_cleanup(ctx)
 #endif
 
 #define libssh2_crypto_init() \
