diff --git a/utils/drmprocessorclientimpl.cpp b/utils/drmprocessorclientimpl.cpp
index d451834..9d49c30 100644
--- a/utils/drmprocessorclientimpl.cpp
+++ b/utils/drmprocessorclientimpl.cpp
@@ -342,7 +342,7 @@ void DRMProcessorClientImpl::RSAPrivateEncrypt(const unsigned char* RSAKey, unsi
     if (PKCS12_parse(pkcs12, password.c_str(), &pkey, NULL, NULL) <= 0)
 	EXCEPTION(gourou::CLIENT_INVALID_PKCS12, ERR_error_string(ERR_get_error(), NULL));
 
-    outlen = EVP_PKEY_get_size(pkey);
+    outlen = EVP_PKEY_size(pkey);
 
     ctx = EVP_PKEY_CTX_new(pkey, NULL);
 
@@ -451,7 +451,7 @@ void* DRMProcessorClientImpl::generateRSAKey(int keyLengthBits)
 
     EVP_PKEY_CTX_set_rsa_keygen_bits(ctx, keyLengthBits);
     EVP_PKEY_CTX_set_rsa_padding(ctx, RSA_PKCS1_PADDING);
-    EVP_PKEY_CTX_set1_rsa_keygen_pubexp(ctx, bn);
+    EVP_PKEY_CTX_set_rsa_keygen_pubexp(ctx, bn);
     EVP_PKEY_keygen(ctx, &key);
 
     EVP_PKEY_CTX_free(ctx);
