--- ntopng-3.4-old/third-party/mongoose/mongoose.c	2018-06-17 15:30:25.000000000 +0200
+++ ntopng-3.4/third-party/mongoose/mongoose.c	2018-08-26 07:32:27.632828581 +0200
@@ -247,7 +247,9 @@
 #define mg_rename(x, y) rename(x, y)
 #define mg_sleep(x) usleep((x) * 1000)
 #define ERRNO errno
+#ifndef INVALID_SOCKET
 #define INVALID_SOCKET (-1)
+#endif
 
 /* ntop */
 #if ((ULONG_MAX) == (UINT_MAX))
@@ -270,7 +272,9 @@
 #endif
 
 //#define INT64_FMT PRId64
+#ifndef SOCKET
 typedef int SOCKET;
+#endif
 #define WINCDECL
 
 #endif // End of Windows and UNIX specific includes
