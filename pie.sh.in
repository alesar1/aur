#!/usr/bin/bash
#
#   pie.sh - Compile executables with address space layout randomization
#

[[ -n "$LIBMAKEPKG_BUILDENV_PIE_SH" ]] && return
LIBMAKEPKG_BUILDENV_PIE_SH=1

LIBRARY=${LIBRARY:-'@libmakepkgdir@'}

source "$LIBRARY/util/option.sh"

build_options+=('pie')
buildenv_functions+=('buildenv_pie')

buildenv_pie() {
	if check_buildoption "pie" "y"; then
		CFLAGS+=" -fpie"
		CXXFLAGS+=" -fpie"
		LDFLAGS+=" -pie"
	fi
}
