From 5df526d039345067201ece2accef05831be5d7d7 Mon Sep 17 00:00:00 2001
From: Vsevolod Stakhov <vsevolod@highsecure.ru>
Date: Tue, 19 Jan 2016 14:20:27 +0000
Subject: [PATCH] Fix variable initialization

Issue: #71
Reported by: @anoter
Tracked by: @pfactum
---
 src/rmilter.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/rmilter.c b/src/rmilter.c
index 5e11a9c..106ddf2 100644
--- a/src/rmilter.c
+++ b/src/rmilter.c
@@ -237,9 +237,14 @@ check_message_id (struct mlfi_priv *priv, char *header)
 	int r, keylen;
 	size_t s, dlen;
 
+	if (header == NULL) {
+		return;
+	}
+
+	s = strlen (header);
+
 	/* First of all do regexp check of message to determine special message id */
 	if (cfg->special_mid_re) {
-		s = strlen (header);
 		if ((r = pcre_exec (cfg->special_mid_re, NULL, header, s, 0, 0, NULL, 0)) >= 0) {
 			priv->complete_to_beanstalk = 1;
 		}
