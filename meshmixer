#!/bin/bash
#Modified from elster package https://aur.archlinux.org/packages/elster/
INSTALL_DIRECTORY="/opt/meshmixer-wine"
export WINEPREFIX="$HOME"/.meshmixer
export WINEARCH="win64"
# don't add shortcuts to desktop and don't install mono or gecko to the new wine bottle
export WINEDLLOVERRIDES="winemenubuilder.exe=d;mscoree=d;mshtml=d"
# don't show debug messages when running wine
export WINEDEBUG="-all"

if [ ! -d "$WINEPREFIX" ] ; then
   mkdir -p "$WINEPREFIX" || exit 1
   # create wine prefix
   wine wineboot
   #install dependency
   winetricks -q vcrun2015
   # symlink needed meshmixer files
   ln -s "$INSTALL_DIRECTORY" "$WINEPREFIX"/drive_c/Program\ Files/meshmixer
fi
# run meshmixer
wine64 "$INSTALL_DIRECTORY/meshmixer.exe" "$@"
