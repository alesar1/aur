From e3dae58bd99c14628bee054ed8b5b5e4213239ff Mon Sep 17 00:00:00 2001
From: "Patrick Burroughs (Celti)" <celti@celti.name>
Date: Fri, 20 May 2016 00:32:31 -0700
Subject: [PATCH] icon fixes

---
 Makefile | 30 ++++++++++++++++++++----------
 1 file changed, 20 insertions(+), 10 deletions(-)

diff --git a/Makefile b/Makefile
index d7fc3f6..4f1c3e5 100644
--- a/Makefile
+++ b/Makefile
@@ -22,8 +22,10 @@
 
 # Service integration id
 APP_ID = owncloud_music
+# Image converter to use (rsvg-convert or lasem-render)
+SVG_CONVERT ?= rsvg-convert
 # Dependencies
-DEPS = rsvg-convert
+DEPS = $(SVG_CONVERT)
 # Default installation destination
 DEST ?= $(HOME)/.local/share/nuvolaplayer3/web_apps
 # Sizes of the whole icon set
@@ -57,27 +59,35 @@ $(ICONS_DIR):
 	
 # Generate icon 16
 $(ICONS_DIR)/16.png: $(SOURCE_ICON_XS) | $(ICONS_DIR)
-	rsvg-convert -w 16 -h 16 $< -o $@
+	$(SVG_CONVERT) -z 0.03125 $< -o $@
 
 # Generate icon 22	
 $(ICONS_DIR)/22.png : $(SOURCE_ICON_XS) | $(ICONS_DIR)
-	rsvg-convert -w 22 -h 22 $< -o $@
+	$(SVG_CONVERT) -z 0.04296875 $< -o $@
 
 # Generate icon 24	
 $(ICONS_DIR)/24.png : $(SOURCE_ICON_XS) | $(ICONS_DIR)
-	rsvg-convert -w 24 -h 24 $< -o $@
+	$(SVG_CONVERT) -z 0.046875 $< -o $@
 
 # Generate icon 32	
 $(ICONS_DIR)/32.png : $(SOURCE_ICON_SM) | $(ICONS_DIR)
-	rsvg-convert -w 32 -h 32 $< -o $@
+	$(SVG_CONVERT) -z 0.0625 $< -o $@
 
 # Generate icon 48
 $(ICONS_DIR)/48.png : $(SOURCE_ICON_SM) | $(ICONS_DIR)
-	rsvg-convert -w 48 -h 48 $< -o $@
+	$(SVG_CONVERT) -z 0.09375 $< -o $@
 
-# Generate icons 64 128 256
-$(ICONS_DIR)/%.png : $(SOURCE_ICON) | $(ICONS_DIR)
-	rsvg-convert -w $* -h $* $< -o $@
+# Generate icon 64
+$(ICONS_DIR)/64.png : $(SOURCE_ICON) | $(ICONS_DIR)
+	$(SVG_CONVERT) -z 0.125 $< -o $@
+
+# Generate icon 128
+$(ICONS_DIR)/128.png : $(SOURCE_ICON) | $(ICONS_DIR)
+	$(SVG_CONVERT) -z 0.25 $< -o $@
+
+# Generate icon 256
+$(ICONS_DIR)/256.png : $(SOURCE_ICON) | $(ICONS_DIR)
+	$(SVG_CONVERT) -z 0.5 $< -o $@
 
 # Copy scalable icon
 $(SCALABLE_ICON) : $(SOURCE_ICON) | $(ICONS_DIR)
@@ -96,7 +106,7 @@ install: $(LICENSES) $(INSTALL_FILES) $(PNG_ICONS) $(SCALABLE_ICON)
 	
 	# Create symlinks to icons
 	mkdir -pv $(DEST)/../../icons/hicolor/scalable/apps || true
-	ln -s -f -v -T ../../../../$(APP_ID)/$(SCALABLE_ICON) \
+	ln -s -f -v -T ../../../../nuvolaplayer3/web_apps/$(APP_ID)/$(SCALABLE_ICON) \
 		$(DEST)/../../icons/hicolor/scalable/apps/nuvolaplayer3_$(APP_ID).svg;
 	for size in $(ICON_SIZES); do \
 		mkdir -pv $(DEST)/../../icons/hicolor/$${size}x$${size}/apps || true ; \
-- 
2.8.2

