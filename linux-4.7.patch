--- r8101-1.029.00/src/r8101_n.c.old
+++ r8101-1.029.00/src/r8101_n.c
@@ -10206,7 +10206,9 @@
                         dev->hw_features &= ~NETIF_F_IPV6_CSUM;
                         netif_set_gso_max_size(dev, LSO_32K);
 #if LINUX_VERSION_CODE >= KERNEL_VERSION(3,18,0)
+#if LINUX_VERSION_CODE < KERNEL_VERSION(4,7,0)
                         dev->gso_min_segs = NIC_MIN_PHYS_BUF_COUNT;
+#endif
                         dev->gso_max_segs = NIC_MAX_PHYS_BUF_COUNT_LSO_64K;
 #endif
                 } else {
@@ -10214,7 +10216,9 @@
                         dev->features |=  NETIF_F_IPV6_CSUM | NETIF_F_TSO6;
                         netif_set_gso_max_size(dev, LSO_64K);
 #if LINUX_VERSION_CODE >= KERNEL_VERSION(3,18,0)
+#if LINUX_VERSION_CODE < KERNEL_VERSION(4,7,0)
                         dev->gso_min_segs = NIC_MIN_PHYS_BUF_COUNT;
+#endif
                         dev->gso_max_segs = NIC_MAX_PHYS_BUF_COUNT_LSO2;
 #endif
                 }
@@ -11865,7 +11869,11 @@
         wmb();
         txd->opts1 = cpu_to_le32(opts1);
 
+#if LINUX_VERSION_CODE < KERNEL_VERSION(4,7,0)
         dev->trans_start = jiffies;
+#else
+        netif_trans_update(dev);
+#endif
 
         tp->cur_tx += frags + 1;
 

