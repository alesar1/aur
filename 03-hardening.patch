--- a/CPP/7zip/7zip_gcc.mak	2021-12-25 15:00:00.000000000 +0100
+++ b/CPP/7zip/7zip_gcc.mak	2022-05-12 21:14:52.909954342 +0200
@@ -126,7 +126,7 @@
 
 
 
-CFLAGS = $(MY_ARCH_2) $(LOCAL_FLAGS) $(CFLAGS_BASE2) $(CFLAGS_BASE) $(CC_SHARED) -o $@
+CFLAGS = $(MY_ARCH_2) $(LOCAL_FLAGS) $(CFLAGS_BASE2) $(CFLAGS_BASE) -fstack-protector-strong $(CC_SHARED) -o $@
 
 
 ifdef IS_MINGW
@@ -154,7 +154,7 @@
 #-Wno-invalid-offsetof
 #-Wno-reorder
 
-CXXFLAGS = $(MY_ARCH_2) $(LOCAL_FLAGS) $(CXXFLAGS_BASE2) $(CFLAGS_BASE) $(CXXFLAGS_EXTRA) $(CC_SHARED) -o $@ $(CXX_WARN_FLAGS)
+CXXFLAGS = $(MY_ARCH_2) $(LOCAL_FLAGS) $(CXXFLAGS_BASE2) $(CFLAGS_BASE) $(CXXFLAGS_EXTRA) -fstack-protector-strong $(CC_SHARED) -o $@ $(CXX_WARN_FLAGS)
 
 STATIC_TARGET=
 ifdef COMPL_STATIC
@@ -167,7 +167,7 @@
 $(O):
 	$(MY_MKDIR) $(O)
 
-LFLAGS_ALL = -s $(MY_ARCH_2) $(LDFLAGS) $(LD_arch) $(OBJS) $(MY_LIBS) $(LIB2)
+LFLAGS_ALL = -s $(MY_ARCH_2) $(LDFLAGS) -Wl,-pie,-z,now,-z,noexecstack $(LD_arch) $(OBJS) $(MY_LIBS) $(LIB2)
 $(PROGPATH): $(OBJS)
 	$(CXX) -o $(PROGPATH) $(LFLAGS_ALL)
 
